<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2.1. Blockade Interaction in a Magnetic Field &#8212; pairinteraction 0.7-alpha-1-ge9dcbd5 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.7-alpha-1-ge9dcbd5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="pairinteraction 0.7-alpha-1-ge9dcbd5 documentation" href="index.html" />
    <link rel="up" title="2. Tutorials" href="tutorials.html" />
    <link rel="next" title="libpairinteraction" href="modules.html" />
    <link rel="prev" title="2. Tutorials" href="tutorials.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="libpairinteraction"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorials.html" title="2. Tutorials"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pairinteraction 0.7-alpha-1-ge9dcbd5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tutorials.html" accesskey="U">2. Tutorials</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="blockade-interaction-in-a-magnetic-field">
<h1>2.1. Blockade Interaction in a Magnetic Field<a class="headerlink" href="#blockade-interaction-in-a-magnetic-field" title="Permalink to this headline">¶</a></h1>
<p>The interaction between Rydberg atoms is strongly influenced by external
electric and magnetic fields. A small magnetic field for instance lifts
the Zeeman degeneracy and thus strengthens the Rydberg blockade,
especially if there is a non-zero angle between the interatomic and the
quantization axis. This has been discussed in M. Saffman, T. G. Walker,
and K. Mølmer, “Quantum information with Rydberg atoms,” <a class="reference external" href="https://dx.doi.org/10.1103/RevModPhys.82.2313">Rev. Mod.
Phys. 82, 2313 (2010)</a>
(<a class="reference external" href="https://journals.aps.org/rmp/article/10.1103/RevModPhys.82.2313/figures/13/medium">Fig.
13</a>).
Here we show how to reproduce this result using pairinteraction.</p>
<p>We start by loading the required modules for the computation. We will
make use of pairinteraction&#8217;s parallel capacities which is why we load
the <code class="docutils literal"><span class="pre">multiprocessing</span></code> module.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="k">import</span> <span class="n">Pool</span>
<span class="kn">from</span> <span class="nn">libpairinteraction</span> <span class="k">import</span> <span class="n">pireal</span> <span class="k">as</span> <span class="n">pi</span>
</pre></div>
</div>
<p>We begin by defining some constants of our calculation: the spatial
separation of the Rydberg atoms and a range of magnetic field we want to
iterate over. The units of the respective quantities are given as
comments.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">distance</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># µm</span>
<span class="n">bfields</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="c1"># Gauss</span>
</pre></div>
</div>
<p>Now, we use pairinteraction&#8217;s <code class="docutils literal"><span class="pre">StateOne</span></code> class to define the
single-atom state <span class="math">\(43d_{5/2}\)</span> of a Rubudium atom.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">state_one</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">StateOne</span><span class="p">(</span><span class="s2">&quot;Rb&quot;</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>To speed up the calculation, pairinteraction caches intermediate
results, like matrix elements, for reuse. Therefore we create a cache
directory, dedicated to such files.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;./cache&quot;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;./cache&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we define how to set up the single atom system. We do this using a
function, so we can easily create systems with the magnetic field as a
parameter. Inside the function we create a new system by passing the
<code class="docutils literal"><span class="pre">state_one</span></code> and the cache directory we created to <code class="docutils literal"><span class="pre">SystemOne</span></code>.</p>
<p>Because energies are calculated non-perturbatively, we have to choose
cutoffs on states which can couple to <code class="docutils literal"><span class="pre">state_one</span></code>. This is done by
means of the <code class="docutils literal"><span class="pre">restrict...</span></code> functions in <code class="docutils literal"><span class="pre">SystemOne</span></code>.</p>
<p>Finally, we set the magnetic field to point in <span class="math">\(z\)</span>-direction with
the magnitude given by the argument.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup_system_one</span><span class="p">(</span><span class="n">bfield</span><span class="p">):</span>
    <span class="n">system_one</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">SystemOne</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;./cache&quot;</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">restrictEnergy</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">energy</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">state_one</span><span class="o">.</span><span class="n">energy</span><span class="o">+</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">restrictN</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">state_one</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">restrictL</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">l</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">state_one</span><span class="o">.</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">setBfield</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bfield</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">system_one</span>
</pre></div>
</div>
<p>To investigate the <span class="math">\(43d_{5/2} + 43d_{5/2}\)</span> pair state, we easily
combine the same single-atom state twice into a pair state using
<code class="docutils literal"><span class="pre">StateTwo</span></code>.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">state_two</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">StateTwo</span><span class="p">(</span><span class="n">state_one</span><span class="p">,</span> <span class="n">state_one</span><span class="p">)</span>
</pre></div>
</div>
<p>Akin to the single atom system, we now define how to create a two atom
system. We want to parametrize this in terms of the single atom system
and the interaction angle.</p>
<p>We compose a <code class="docutils literal"><span class="pre">SystemTwo</span></code> from two <code class="docutils literal"><span class="pre">system_one</span></code> because we are
looking at two identical atoms. Again we have to restrict the energy
range for coupling. Then we proceed to set the distance between the two
atoms and the interaction angle.</p>
<p>To speed up the calculation, we can tell pairinteraction that this
system will have some symmetries.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup_system_two</span><span class="p">(</span><span class="n">system_one</span><span class="p">,</span><span class="n">angle</span><span class="p">):</span>
    <span class="n">system_two</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">SystemTwo</span><span class="p">(</span><span class="n">system_one</span><span class="p">,</span> <span class="n">system_one</span><span class="p">,</span> <span class="s2">&quot;./cache&quot;</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">restrictEnergy</span><span class="p">(</span><span class="n">state_two</span><span class="o">.</span><span class="n">energy</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">state_two</span><span class="o">.</span><span class="n">energy</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">setDistance</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">angle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">system_two</span><span class="o">.</span><span class="n">setConservedMomentaUnderRotation</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">state_one</span><span class="o">.</span><span class="n">m</span><span class="p">)])</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">setConservedParityUnderInversion</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">ODD</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">setConservedParityUnderPermutation</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">ODD</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">system_two</span>
</pre></div>
</div>
<p>Now, we can use the definitions from above to compose our calculation.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getEnergies</span><span class="p">(</span><span class="n">bfield</span><span class="p">):</span>
    <span class="c1"># Set up one atom system</span>
    <span class="n">system_one</span> <span class="o">=</span> <span class="n">setup_system_one</span><span class="p">(</span><span class="n">bfield</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">()</span>

    <span class="c1"># Calculate Zeeman shift</span>
    <span class="n">zeemanshift</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">system_one</span><span class="o">.</span><span class="n">diagonal</span><span class="p">[</span><span class="n">system_one</span><span class="o">.</span><span class="n">getVectorindex</span><span class="p">(</span><span class="n">state_one</span><span class="p">)]</span>

    <span class="c1"># Set up two atom system</span>
    <span class="n">system_two</span> <span class="o">=</span> <span class="n">setup_system_two</span><span class="p">(</span><span class="n">system_one</span><span class="p">,</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">()</span>

    <span class="c1"># Calculate blockade interaction</span>
    <span class="n">eigenenergies</span> <span class="o">=</span> <span class="p">(</span><span class="n">system_two</span><span class="o">.</span><span class="n">diagonal</span><span class="o">-</span><span class="n">zeemanshift</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span> <span class="c1"># MHz</span>
    <span class="n">overlaps</span> <span class="o">=</span> <span class="n">system_two</span><span class="o">.</span><span class="n">getOverlap</span><span class="p">(</span><span class="n">state_two</span><span class="p">)</span>
    <span class="n">blockade</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">overlaps</span><span class="o">/</span><span class="n">eigenenergies</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">blockade</span>
</pre></div>
</div>
<p>With a little boiler-plate, we can then calculate and plot the result
with <code class="docutils literal"><span class="pre">matplotlib</span></code>.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$B$ (Gauss)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Blockade (MHz)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">angle</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># rad</span>
<span class="k">with</span> <span class="n">Pool</span><span class="p">()</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
    <span class="n">energies1</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getEnergies</span><span class="p">,</span> <span class="n">bfields</span><span class="p">)</span>

<span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># rad</span>
<span class="k">with</span> <span class="n">Pool</span><span class="p">()</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
    <span class="n">energies2</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getEnergies</span><span class="p">,</span> <span class="n">bfields</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bfields</span><span class="p">,</span> <span class="n">energies1</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\theta = 0$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bfields</span><span class="p">,</span> <span class="n">energies2</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\theta = \pi/2$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/comparison_to_saffman_fig13_20_0.png" src="_images/comparison_to_saffman_fig13_20_0.png" />
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo48x48.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorials.html"
                        title="previous chapter">2. Tutorials</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="modules.html"
                        title="next chapter">libpairinteraction</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/comparison_to_saffman_fig13.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="libpairinteraction"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorials.html" title="2. Tutorials"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pairinteraction 0.7-alpha-1-ge9dcbd5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tutorials.html" >2. Tutorials</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Sebastian Weber, Henri Menke.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.9.
    </div>
  </body>
</html>