

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.2. Rydberg Pair Potentials Under External Fields &mdash; pairinteraction 0.8-alpha-30-g0f5bd7f documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="pairinteraction 0.8-alpha-30-g0f5bd7f documentation" href="index.html"/>
        <link rel="up" title="2. Tutorials" href="tutorials.html"/>
        <link rel="next" title="Modules" href="modules.html"/>
        <link rel="prev" title="2.1. Blockade Interaction in a Magnetic Field" href="comparison_to_saffman_fig13.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pairinteraction
          

          
            
            <img src="_static/logo48x48.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.8-alpha-30-g0f5bd7f
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Obtaining pairinteraction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">2. Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="comparison_to_saffman_fig13.html">2.1. Blockade Interaction in a Magnetic Field</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.2. Rydberg Pair Potentials Under External Fields</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Indices and Tables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">pairinteraction</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="tutorials.html">2. Tutorials</a> &raquo;</li>
      
    <li>2.2. Rydberg Pair Potentials Under External Fields</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/pair_potential_efield_sensitivity.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rydberg-pair-potentials-under-external-fields">
<h1>2.2. Rydberg Pair Potentials Under External Fields<a class="headerlink" href="#rydberg-pair-potentials-under-external-fields" title="Permalink to this headline">¶</a></h1>
<p>Experimental parameters have to be chosen carefully to maintain the
Rydberg blockade as discussed in S. de Léséleuc, S. Weber, V. Lienhard,
D. Barredo, H.P. Büchler, T. Lahaye, A. Browaeys, “Accurate mapping of
multilevel Rydberg atoms on interacting spin-1/2 particles for the
quantum simulation of Ising models”,
<a class="reference external" href="https://arxiv.org/abs/1710.06156">arXiv:1710.06156</a>. Here we
reproduce the result shown in Fig. 2c,d that the Rydberg blockade of
<span class="math">\(nD\)</span>-states can be broken by suprisingly small electric fields,
i.e. by fields which cause only a tiny single-atom Stark shift. The
parameter dependence of the electric field sensitivity can be studied by
rerunning the Jupyter notebook for different interaction angles,
external magnetic fields, or principal quantum numbers.</p>
<p>The <a class="reference external" href="https://github.com/pairinteraction/pairinteraction/blob/master/doc/sphinx/examples_python/pair_potential_efield_sensitivity.ipynb">Jupyter
notebook</a>
and the final <a class="reference external" href="https://github.com/pairinteraction/pairinteraction/blob/master/doc/sphinx/examples_python/pair_potential_efield_sensitivity.py">Python
script</a>
are available on GitHub.</p>
<p>Ahead of our Python code, we call an IPython magic function to make the
output of plotting commands displayed inline within the notebook.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<p>Our code starts with loading the required modules for the computation.
We will make use of pairinteraction&#8217;s parallel capacities which is why
we load the <code class="docutils literal"><span class="pre">multiprocessing</span></code> module if supported by the operating
system (in Windows, the module only works with methods defined outside
an IPython notebook). We use the module <code class="docutils literal"><span class="pre">pireal</span></code> as the Hamiltonian
matrix of our system will be purely real-valued.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Arrays</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">cycler</span> <span class="k">import</span> <span class="n">cycler</span>

<span class="c1"># Parallel computing</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">!=</span> <span class="s2">&quot;win32&quot;</span><span class="p">:</span> <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="k">import</span> <span class="n">Pool</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>

<span class="c1"># Platform specific</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;darwin&quot;</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;/Applications/pairinteraction.app/Contents/Resources&quot;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;win32&quot;</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;C:\Program Files\pairinteraction&quot;</span><span class="p">)</span>

<span class="c1"># pairinteraction :-)</span>
<span class="kn">from</span> <span class="nn">libpairinteraction</span> <span class="k">import</span> <span class="n">pireal</span> <span class="k">as</span> <span class="n">pi</span>
</pre></div>
</div>
<p>We begin by defining some constants of our calculation: the spatial
separations of the Rydberg atoms for which we want to evaluate the pair
potential, a zero and non-zero electric field, the external magnetic
field, and a generic interaction angle. The units of the respective
quantities are given as comments.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="c1"># µm</span>
<span class="n">efields</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.020</span><span class="p">]</span> <span class="c1"># V/cm</span>
<span class="n">bfield</span> <span class="o">=</span> <span class="mf">6.9</span> <span class="c1"># Gauss</span>
<span class="n">angle</span> <span class="o">=</span> <span class="mi">78</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span> <span class="c1"># rad</span>
</pre></div>
</div>
<p>Now, we use pairinteraction&#8217;s <code class="docutils literal"><span class="pre">StateOne</span></code> class to define the
single-atom state <span class="math">\(\left|61d_{3/2},m_j=3/2\right\rangle\)</span> of a
Rubudium atom.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">state_one</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">StateOne</span><span class="p">(</span><span class="s2">&quot;Rb&quot;</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
<p>To speed up the calculation, pairinteraction caches intermediate
results, like matrix elements, for reuse. Therefore, we create a cache
directory, dedicated to such files.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;./cache&quot;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;./cache&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we define how to set up the single atom system. We do this using a
function, so we can easily create systems with the electric field as a
parameter. Inside the function, we create a new system by passing the
<code class="docutils literal"><span class="pre">state_one</span></code> and the cache directory we created to <code class="docutils literal"><span class="pre">SystemOne</span></code>.</p>
<p>To limit the size of the basis, we have to choose cutoffs on states
which couple to <code class="docutils literal"><span class="pre">state_one</span></code>. This is done by means of the
<code class="docutils literal"><span class="pre">restrict...</span></code> functions in <code class="docutils literal"><span class="pre">SystemOne</span></code>.</p>
<p>We set the external fields to point in <span class="math">\(z\)</span>-direction.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup_system_one</span><span class="p">(</span><span class="n">efield</span><span class="p">):</span>
    <span class="n">system_one</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">SystemOne</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;./cache&quot;</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">restrictEnergy</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">energy</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">state_one</span><span class="o">.</span><span class="n">energy</span><span class="o">+</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">restrictN</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">state_one</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">restrictL</span><span class="p">(</span><span class="n">state_one</span><span class="o">.</span><span class="n">l</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">state_one</span><span class="o">.</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">setBfield</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bfield</span><span class="p">])</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">setEfield</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">efield</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">system_one</span>
</pre></div>
</div>
<p>To investigate the
<span class="math">\(\left|61d_{3/2},m_j=3/2;61d_{3/2},m_j=3/2\right\rangle\)</span> pair
state, we combine the same single-atom state twice into a pair state
using <code class="docutils literal"><span class="pre">StateTwo</span></code>.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">state_two</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">StateTwo</span><span class="p">(</span><span class="n">state_one</span><span class="p">,</span> <span class="n">state_one</span><span class="p">)</span>
</pre></div>
</div>
<p>Akin to the single atom system, we now define how to create a two atom
system. We want to parametrize this in terms of the single atom system
and the spatial separation.</p>
<p>We compose a <code class="docutils literal"><span class="pre">SystemTwo</span></code> from two identical <code class="docutils literal"><span class="pre">system_one</span></code> because we
are looking at two identical atoms. Again, we have to restrict the
energy range for coupling. Then we proceed to set the distance between
the two atoms and the interaction angle.</p>
<p>To speed up the calculation, we tell pairinteraction that this system
will have some symmetries.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup_system_two</span><span class="p">(</span><span class="n">system_one</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
    <span class="n">system_two</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">SystemTwo</span><span class="p">(</span><span class="n">system_one</span><span class="p">,</span> <span class="n">system_one</span><span class="p">,</span> <span class="s2">&quot;./cache&quot;</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">restrictEnergy</span><span class="p">(</span><span class="n">state_two</span><span class="o">.</span><span class="n">energy</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">state_two</span><span class="o">.</span><span class="n">energy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">setDistance</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">setConservedParityUnderPermutation</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">ODD</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">system_two</span>
</pre></div>
</div>
<p>Now, we use the definitions from above to compose our calculation. Since
we are only interested in pair potential curves close to the
investigated pair state, we further restrict the energy range after
diagonalizing the two atom system.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getSystems</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">system_one</span><span class="p">,</span> <span class="n">fieldshift</span><span class="p">):</span>
    <span class="c1"># Set up two atom system</span>
    <span class="n">system_two</span> <span class="o">=</span> <span class="n">setup_system_two</span><span class="p">(</span><span class="n">system_one</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">()</span>

    <span class="c1"># Restrict the calculated eigenenergies</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">restrictEnergy</span><span class="p">(</span><span class="n">fieldshift</span><span class="o">-</span><span class="mf">0.015</span><span class="p">,</span> <span class="n">fieldshift</span><span class="o">+</span><span class="mf">0.015</span><span class="p">)</span>
    <span class="n">system_two</span><span class="o">.</span><span class="n">buildHamiltonian</span><span class="p">()</span> <span class="c1"># has to be called to apply the new restriction in energy</span>

    <span class="k">return</span> <span class="n">system_two</span>
</pre></div>
</div>
<p>Finally, we run the calculations for the given values of the electric
field. The method <code class="docutils literal"><span class="pre">getConnections</span></code> tells which eigenenergies are
adiabatically connected and make up pair potential curves. Using
<code class="docutils literal"><span class="pre">matplotlib</span></code>, we plot the resulting pair potential curves which are
colored accordingly to the overlap with the investigated pair state.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">efield</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">efields</span><span class="p">):</span>
    <span class="c1"># Set up one atom systems</span>
    <span class="n">system_one</span> <span class="o">=</span> <span class="n">setup_system_one</span><span class="p">(</span><span class="n">efield</span><span class="p">)</span>
    <span class="n">system_one</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">()</span>
    <span class="n">fieldshift</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">system_one</span><span class="o">.</span><span class="n">diagonal</span><span class="p">[</span><span class="n">system_one</span><span class="o">.</span><span class="n">getVectorindex</span><span class="p">(</span><span class="n">state_one</span><span class="p">)]</span>

    <span class="c1"># Get diagonalized two atom systems</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">!=</span> <span class="s2">&quot;win32&quot;</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Pool</span><span class="p">()</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
            <span class="n">systems_two</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">getSystems</span><span class="p">,</span> <span class="n">system_one</span><span class="o">=</span><span class="n">system_one</span><span class="p">,</span> <span class="n">fieldshift</span><span class="o">=</span><span class="n">fieldshift</span><span class="p">),</span> <span class="n">distances</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">systems_two</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">getSystems</span><span class="p">,</span> <span class="n">system_one</span><span class="o">=</span><span class="n">system_one</span><span class="p">,</span> <span class="n">fieldshift</span><span class="o">=</span><span class="n">fieldshift</span><span class="p">),</span> <span class="n">distances</span><span class="p">))</span>

    <span class="c1"># Plot pair potentials</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$E_z$ = $</span><span class="si">{}</span><span class="s2">$ mV/cm&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">efield</span><span class="o">*</span><span class="mf">1e3</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Distance (µm)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">distances</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">systems_two</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">systems_two</span><span class="p">))):</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">systems_two</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">getConnections</span><span class="p">(</span><span class="n">systems_two</span><span class="p">[</span><span class="n">i2</span><span class="p">],</span> <span class="mf">0.001</span><span class="p">))</span>
        <span class="n">segment_distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">distances</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span><span class="n">distances</span><span class="p">[</span><span class="n">i2</span><span class="p">]]</span>
        <span class="n">segment_energies</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">systems_two</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">diagonal</span><span class="p">[</span><span class="n">c1</span><span class="p">],</span>
                                      <span class="n">systems_two</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span><span class="o">.</span><span class="n">diagonal</span><span class="p">[</span><span class="n">c2</span><span class="p">]])</span><span class="o">-</span><span class="n">fieldshift</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span> <span class="c1"># MHz</span>
        <span class="n">segment_overlap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">systems_two</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">getOverlap</span><span class="p">(</span><span class="n">state_two</span><span class="p">)[</span><span class="n">c1</span><span class="p">],</span>
                                   <span class="n">systems_two</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span><span class="o">.</span><span class="n">getOverlap</span><span class="p">(</span><span class="n">state_two</span><span class="p">)[</span><span class="n">c2</span><span class="p">]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">segment_color</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis_r</span><span class="p">(</span><span class="n">segment_overlap</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">segment_color</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">segment_distances</span><span class="p">,</span> <span class="n">segment_energies</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Energy (MHz)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([]);</span>
</pre></div>
</div>
<img alt="_images/pair_potential_efield_sensitivity_21_0.png" src="_images/pair_potential_efield_sensitivity_21_0.png" />
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="modules.html" class="btn btn-neutral float-right" title="Modules" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="comparison_to_saffman_fig13.html" class="btn btn-neutral" title="2.1. Blockade Interaction in a Magnetic Field" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Sebastian Weber, Henri Menke.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.8-alpha-30-g0f5bd7f',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>