<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pairinteraction: /travis/libpairinteraction/eigen/Eigen/src/SVD/BDCSVD.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo72x72.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">pairinteraction
   </div>
   <div id="projectbrief">A Rydberg Interaction Calculator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('BDCSVD_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BDCSVD.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="BDCSVD_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// This file is part of Eigen, a lightweight C++ template library</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// for linear algebra.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// We used the &quot;A Divide-And-Conquer Algorithm for the Bidiagonal SVD&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// research report written by Ming Gu and Stanley C.Eisenstat</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// The code variable names correspond to the names they used in their </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// report</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Copyright (C) 2013 Gauthier Brun &lt;brun.gauthier@gmail.com&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// Copyright (C) 2013 Nicolas Carre &lt;nicolas.carre@ensimag.fr&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// Copyright (C) 2013 Jean Ceccato &lt;jean.ceccato@ensimag.fr&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// Copyright (C) 2013 Pierre Zoppitelli &lt;pierre.zoppitelli@ensimag.fr&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// Copyright (C) 2013 Jitse Niesen &lt;jitse@maths.leeds.ac.uk&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// Copyright (C) 2014-2016 Gael Guennebaud &lt;gael.guennebaud@inria.fr&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// Source Code Form is subject to the terms of the Mozilla</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// Public License v. 2.0. If a copy of the MPL was not distributed</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#ifndef EIGEN_BDCSVD_H</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#define EIGEN_BDCSVD_H</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// #define EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// #define EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceEigen.html">Eigen</a> {</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;IOFormat bdcsvdfmt(8, 0, <span class="stringliteral">&quot;, &quot;</span>, <span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;  [&quot;</span>, <span class="stringliteral">&quot;]&quot;</span>);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  </div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> _MatrixType&gt; <span class="keyword">class </span>BDCSVD;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceinternal.html">internal</a> {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> _MatrixType&gt; </div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structEigen_1_1internal_1_1traits_3_01BDCSVD_3_01__MatrixType_01_4_01_4.html">   36</a></span>&#160;<span class="keyword">struct </span><a class="code" href="namespacetraits.html">traits</a>&lt;<a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD</a>&lt;_MatrixType&gt; &gt;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="structEigen_1_1internal_1_1traits_3_01BDCSVD_3_01__MatrixType_01_4_01_4.html#afd85342058bafd2b0fd201db71b54f50">   38</a></span>&#160;  <span class="keyword">typedef</span> _MatrixType <a class="code" href="structEigen_1_1internal_1_1traits_3_01BDCSVD_3_01__MatrixType_01_4_01_4.html#afd85342058bafd2b0fd201db71b54f50">MatrixType</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;};  </div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;} <span class="comment">// end namespace internal</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/** \ingroup SVD_Module</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * \class BDCSVD</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * \brief class Bidiagonal Divide and Conquer SVD</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> * \tparam _MatrixType the type of the matrix of which we are computing the SVD decomposition</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> * This class first reduces the input matrix to bi-diagonal form using class UpperBidiagonalization,</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> * and then performs a divide-and-conquer diagonalization. Small blocks are diagonalized using class JacobiSVD.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> * You can control the switching size with the setSwitchSize() method, default is 16.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> * For small matrice (&lt;16), it is thus preferable to directly use JacobiSVD. For larger ones, BDCSVD is highly</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> * recommended and can several order of magnitude faster.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> * \warning this algorithm is unlikely to provide accurate result when compiled with unsafe math optimizations.</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> * For instance, this concerns Intel&#39;s compiler (ICC), which perfroms such optimization by default unless</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> * you compile with the \c -fp-model \c precise option. Likewise, the \c -ffast-math option of GCC or clang will</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> * significantly degrade the accuracy.</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> * \sa class JacobiSVD</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> _MatrixType&gt; </div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">class </span><a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD</a> : <span class="keyword">public</span> <a class="code" href="classEigen_1_1SVDBase.html">SVDBase</a>&lt;BDCSVD&lt;_MatrixType&gt; &gt;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1SVDBase.html">SVDBase&lt;BDCSVD&gt;</a> Base;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    </div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">using</span> <a class="code" href="Tutorial__commainit__02_8cpp.html#a061459acc9e078fa4699e0e349887215">Base::rows</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keyword">using</span> <a class="code" href="Tutorial__commainit__02_8cpp.html#a4407a60bc4387adae24cee658711f2d9">Base::cols</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keyword">using</span> Base::computeU;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keyword">using</span> Base::computeV;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  </div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a8c3310eee662af4ca2428f7afd1472ed">   77</a></span>&#160;  <span class="keyword">typedef</span> _MatrixType <a class="code" href="classEigen_1_1BDCSVD.html#a8c3310eee662af4ca2428f7afd1472ed">MatrixType</a>;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#aaeab2cfc3f87e2a2c595a9d5b4d97c71">   78</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">MatrixType::Scalar</a> <a class="code" href="classEigen_1_1BDCSVD.html#aaeab2cfc3f87e2a2c595a9d5b4d97c71">Scalar</a>;</div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">   79</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;typename MatrixType::Scalar&gt;::Real</a> <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a>;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">   80</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;RealScalar&gt;::Literal</a> <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">enum</span> {</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a6c791d5481ea7aed01ea45814995a37caa0222fb3be5089e2f7ca67e1e2882954">   82</a></span>&#160;    RowsAtCompileTime = MatrixType::RowsAtCompileTime, </div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a6c791d5481ea7aed01ea45814995a37caf0a020e5fd77a8f6f2cfb7145c8da295">   83</a></span>&#160;    ColsAtCompileTime = MatrixType::ColsAtCompileTime, </div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a6c791d5481ea7aed01ea45814995a37ca135cfd5fd712f17e50bdc0efa61cc366">   84</a></span>&#160;    DiagSizeAtCompileTime = <a class="code" href="Macros_8h.html#a2a07ba221d47a7d636fd13678c8c75b3">EIGEN_SIZE_MIN_PREFER_DYNAMIC</a>(RowsAtCompileTime, ColsAtCompileTime), </div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a6c791d5481ea7aed01ea45814995a37ca75ab90cba2fd1bdc327e07d349be1fd9">   85</a></span>&#160;    MaxRowsAtCompileTime = MatrixType::MaxRowsAtCompileTime, </div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a6c791d5481ea7aed01ea45814995a37ca0d30a3a19367ab871e64a980aea219f0">   86</a></span>&#160;    MaxColsAtCompileTime = MatrixType::MaxColsAtCompileTime, </div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a6c791d5481ea7aed01ea45814995a37cab37c73c7ace3196b7a9b799a33492116">   87</a></span>&#160;    MaxDiagSizeAtCompileTime = <a class="code" href="Macros_8h.html#af2d58514e6156c4da2d4af66fafd0b12">EIGEN_SIZE_MIN_PREFER_FIXED</a>(MaxRowsAtCompileTime, MaxColsAtCompileTime), </div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a6c791d5481ea7aed01ea45814995a37caaac5b9fa1cd1464ae3ec6ffa7b86a95d">   88</a></span>&#160;    MatrixOptions = MatrixType::Options</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  };</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a4c38005126c75b1ba3b1b95117b4546d">   91</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classEigen_1_1Matrix.html">Base::MatrixUType</a> <a class="code" href="classEigen_1_1BDCSVD.html#a4c38005126c75b1ba3b1b95117b4546d">MatrixUType</a>;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a1a1140cddb7727637b5e33d9f3b13299">   92</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classEigen_1_1Matrix.html">Base::MatrixVType</a> <a class="code" href="classEigen_1_1BDCSVD.html#a1a1140cddb7727637b5e33d9f3b13299">MatrixVType</a>;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a44cd685aa8d3807c006f6557bd69abf8">   93</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classEigen_1_1SVDBase.html#a7426695e87c152fbb8bc7834dd8e6ce3">Base::SingularValuesType</a> <a class="code" href="classEigen_1_1BDCSVD.html#a44cd685aa8d3807c006f6557bd69abf8">SingularValuesType</a>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  </div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#acf9211e5353d60fc3209d62fa0e2bdf7">   95</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1Matrix.html">Matrix&lt;Scalar, Dynamic, Dynamic, ColMajor&gt;</a> <a class="code" href="classEigen_1_1BDCSVD.html#acf9211e5353d60fc3209d62fa0e2bdf7">MatrixX</a>;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">   96</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1Matrix.html">Matrix&lt;RealScalar, Dynamic, Dynamic, ColMajor&gt;</a> <a class="code" href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">MatrixXr</a>;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a0ea2c57bf088d5fc480ad81945157079">   97</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1Matrix.html">Matrix&lt;RealScalar, Dynamic, 1&gt;</a> <a class="code" href="classEigen_1_1BDCSVD.html#a0ea2c57bf088d5fc480ad81945157079">VectorType</a>;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a1e177918a1acf8153ff5f323fbeed9fe">   98</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1Array.html">Array&lt;RealScalar, Dynamic, 1&gt;</a> <a class="code" href="classEigen_1_1BDCSVD.html#a1e177918a1acf8153ff5f323fbeed9fe">ArrayXr</a>;</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a9dea0e28217993ad7de85351357724a7">   99</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1Array.html">Array&lt;Index,1,Dynamic&gt;</a> <a class="code" href="classEigen_1_1BDCSVD.html#a9dea0e28217993ad7de85351357724a7">ArrayXi</a>;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">  100</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1Ref.html">Ref&lt;ArrayXr&gt;</a> <a class="code" href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">ArrayRef</a>;</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#aab1c377c616062cc85356e47312cb412">  101</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classEigen_1_1Ref.html">Ref&lt;ArrayXi&gt;</a> <a class="code" href="classEigen_1_1BDCSVD.html#aab1c377c616062cc85356e47312cb412">IndicesRef</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">  /** \brief Default Constructor.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">   * The default constructor is useful in cases in which the user intends to</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">   * perform decompositions via BDCSVD::compute(const MatrixType&amp;).</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a39514816d38f9c418cf3f3514b511c2c">  108</a></span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a39514816d38f9c418cf3f3514b511c2c">BDCSVD</a>() : m_algoswap(16), m_numIters(0)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  {}</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">  /** \brief Default Constructor with memory preallocation</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">   * Like the default constructor but with preallocation of the internal data</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">   * according to the specified problem size.</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">   * \sa BDCSVD()</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a3e1fa48b3d042b7daf7392724a68bb60">  118</a></span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a3e1fa48b3d042b7daf7392724a68bb60">BDCSVD</a>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="Tutorial__commainit__02_8cpp.html#a061459acc9e078fa4699e0e349887215">rows</a>, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="Tutorial__commainit__02_8cpp.html#a4407a60bc4387adae24cee658711f2d9">cols</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions = 0)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    : m_algoswap(16), m_numIters(0)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    allocate(rows, cols, computationOptions);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">  /** \brief Constructor performing the decomposition of given matrix.</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">   * \param matrix the matrix to decompose</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">   * \param computationOptions optional parameter allowing to specify if you want full or thin U or V unitaries to be computed.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">   *                           By default, none is computed. This is a bit - field, the possible bits are #ComputeFullU, #ComputeThinU, </span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">   *                           #ComputeFullV, #ComputeThinV.</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">   * Thin unitaries are only available if your matrix type has a Dynamic number of columns (for example MatrixXf). They also are not</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">   * available with the (non - default) FullPivHouseholderQR preconditioner.</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a302746d9c534cd513c1df87c7ae4850d">  134</a></span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a302746d9c534cd513c1df87c7ae4850d">BDCSVD</a>(<span class="keyword">const</span> MatrixType&amp; <a class="code" href="common_8h.html#a94360d20ee722c1bcb23e5b2fbba8554">matrix</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions = 0)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    : m_algoswap(16), m_numIters(0)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="dense__solvers_8cpp.html#a8ef543dd0111424127c81cdd31f3753a">compute</a>(matrix, computationOptions);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#abdf2b178ad413766bc1b292fcef701e2">  140</a></span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#abdf2b178ad413766bc1b292fcef701e2">~BDCSVD</a>() </div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">  /** \brief Method performing the decomposition of given matrix using custom options.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">   * \param matrix the matrix to decompose</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">   * \param computationOptions optional parameter allowing to specify if you want full or thin U or V unitaries to be computed.</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">   *                           By default, none is computed. This is a bit - field, the possible bits are #ComputeFullU, #ComputeThinU, </span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">   *                           #ComputeFullV, #ComputeThinV.</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">   * Thin unitaries are only available if your matrix type has a Dynamic number of columns (for example MatrixXf). They also are not</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">   * available with the (non - default) FullPivHouseholderQR preconditioner.</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD</a>&amp; <a class="code" href="dense__solvers_8cpp.html#a8ef543dd0111424127c81cdd31f3753a">compute</a>(<span class="keyword">const</span> MatrixType&amp; <a class="code" href="common_8h.html#a94360d20ee722c1bcb23e5b2fbba8554">matrix</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">  /** \brief Method performing the decomposition of given matrix using current options.</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">   * \param matrix the matrix to decompose</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">   * This method uses the current \a computationOptions, as already passed to the constructor or to compute(const MatrixType&amp;, unsigned int).</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#acf27f41ed044d74ea8e8cbaf17ffdb04">  162</a></span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD</a>&amp; <a class="code" href="classEigen_1_1BDCSVD.html#acf27f41ed044d74ea8e8cbaf17ffdb04">compute</a>(<span class="keyword">const</span> MatrixType&amp; matrix)</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="dense__solvers_8cpp.html#a8ef543dd0111424127c81cdd31f3753a">compute</a>(matrix, this-&gt;m_computationOptions);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#aa21c0cc5e99c861970bae45d94cae9ad">  167</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html#aa21c0cc5e99c861970bae45d94cae9ad">setSwitchSize</a>(<span class="keywordtype">int</span> <a class="code" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) </div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a>(s&gt;3 &amp;&amp; <span class="stringliteral">&quot;BDCSVD the size of the algo switch has to be greater than 3&quot;</span>);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    m_algoswap = <a class="code" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">void</span> allocate(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="Tutorial__commainit__02_8cpp.html#a061459acc9e078fa4699e0e349887215">rows</a>, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="Tutorial__commainit__02_8cpp.html#a4407a60bc4387adae24cee658711f2d9">cols</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">void</span> divide(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> lastCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstRowW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> shift);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">void</span> computeSVDofM(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, MatrixXr&amp; U, VectorType&amp; singVals, MatrixXr&amp; <a class="code" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">void</span> computeSingVals(<span class="keyword">const</span> ArrayRef&amp; col0, <span class="keyword">const</span> ArrayRef&amp; diag, <span class="keyword">const</span> IndicesRef&amp; perm, VectorType&amp; singVals, ArrayRef shifts, ArrayRef mus);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordtype">void</span> perturbCol0(<span class="keyword">const</span> ArrayRef&amp; col0, <span class="keyword">const</span> ArrayRef&amp; diag, <span class="keyword">const</span> IndicesRef&amp; perm, <span class="keyword">const</span> VectorType&amp; singVals, <span class="keyword">const</span> ArrayRef&amp; shifts, <span class="keyword">const</span> ArrayRef&amp; mus, ArrayRef zhat);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordtype">void</span> computeSingVecs(<span class="keyword">const</span> ArrayRef&amp; zhat, <span class="keyword">const</span> ArrayRef&amp; diag, <span class="keyword">const</span> IndicesRef&amp; perm, <span class="keyword">const</span> VectorType&amp; singVals, <span class="keyword">const</span> ArrayRef&amp; shifts, <span class="keyword">const</span> ArrayRef&amp; mus, MatrixXr&amp; U, MatrixXr&amp; V);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">void</span> deflation43(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> shift, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="benchVecAdd_8cpp.html#acc017e1f28bf1b83809251a830f315c3">size</a>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordtype">void</span> deflation44(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColu , <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColm, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstRowW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> i, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> size);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordtype">void</span> deflation(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> lastCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstRowW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> shift);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> HouseholderU, <span class="keyword">typename</span> HouseholderV, <span class="keyword">typename</span> NaiveU, <span class="keyword">typename</span> NaiveV&gt;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">void</span> copyUV(<span class="keyword">const</span> HouseholderU &amp;householderU, <span class="keyword">const</span> HouseholderV &amp;householderV, <span class="keyword">const</span> NaiveU &amp;naiveU, <span class="keyword">const</span> NaiveV &amp;naivev);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">void</span> structured_update(<a class="code" href="classEigen_1_1Block.html">Block&lt;MatrixXr,Dynamic,Dynamic&gt;</a> <a class="code" href="classEigen_1_1Matrix.html">A</a>, <span class="keyword">const</span> MatrixXr &amp;<a class="code" href="classEigen_1_1Matrix.html">B</a>, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> n1);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keyword">static</span> RealScalar secularEq(RealScalar <a class="code" href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a>, <span class="keyword">const</span> ArrayRef&amp; col0, <span class="keyword">const</span> ArrayRef&amp; diag, <span class="keyword">const</span> IndicesRef &amp;perm, <span class="keyword">const</span> ArrayRef&amp; diagShifted, RealScalar shift);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a94b71ee8ecf0b6b621a1267cf136adc9">  189</a></span>&#160;  MatrixXr m_naiveU, <a class="code" href="classEigen_1_1BDCSVD.html#a94b71ee8ecf0b6b621a1267cf136adc9">m_naiveV</a>;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a76dcaed5bc2dd1c37832805fa8fed943">  190</a></span>&#160;  MatrixXr <a class="code" href="classEigen_1_1BDCSVD.html#a76dcaed5bc2dd1c37832805fa8fed943">m_computed</a>;</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a43bb7c5a142ebde4c38967c5c3d42910">  191</a></span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="classEigen_1_1BDCSVD.html#a43bb7c5a142ebde4c38967c5c3d42910">m_nRec</a>;</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#ad62998546febd86ba715a9eae4c47b4b">  192</a></span>&#160;  ArrayXr <a class="code" href="classEigen_1_1BDCSVD.html#ad62998546febd86ba715a9eae4c47b4b">m_workspace</a>;</div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a8bfc4be4bdc669038298ea29b940532f">  193</a></span>&#160;  ArrayXi <a class="code" href="classEigen_1_1BDCSVD.html#a8bfc4be4bdc669038298ea29b940532f">m_workspaceI</a>;</div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a1e07b25c4a606cee8f34cdc75189a3b8">  194</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classEigen_1_1BDCSVD.html#a1e07b25c4a606cee8f34cdc75189a3b8">m_algoswap</a>;</div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a01ac6b6ddf81569780bf6449e8484a6c">  195</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classEigen_1_1BDCSVD.html#a01ac6b6ddf81569780bf6449e8484a6c">m_isTranspose</a>, m_compU, m_compV;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  </div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keyword">using</span> Base::m_singularValues;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keyword">using</span> Base::m_diagSize;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">using</span> Base::m_computeFullU;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keyword">using</span> Base::m_computeFullV;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keyword">using</span> Base::m_computeThinU;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keyword">using</span> Base::m_computeThinV;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keyword">using</span> Base::m_matrixU;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keyword">using</span> Base::m_matrixV;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keyword">using</span> Base::m_isInitialized;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keyword">using</span> Base::m_nonzeroSingularValues;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keyword">public</span>:  </div><div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#ade7ebb87b1735432218681831b1801cc">  209</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classEigen_1_1BDCSVD.html#ade7ebb87b1735432218681831b1801cc">m_numIters</a>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}; <span class="comment">//end class BDCSVD</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">// Method to allocate and initialize matrix and attributes</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::allocate</a>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="Tutorial__commainit__02_8cpp.html#a061459acc9e078fa4699e0e349887215">rows</a>, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="Tutorial__commainit__02_8cpp.html#a4407a60bc4387adae24cee658711f2d9">cols</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  m_isTranspose = (cols &gt; <a class="code" href="Tutorial__commainit__02_8cpp.html#a061459acc9e078fa4699e0e349887215">rows</a>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordflow">if</span> (Base::allocate(rows, cols, computationOptions))</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  </div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  m_computed = MatrixXr::Zero(m_diagSize + 1, m_diagSize );</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  m_compU = computeV();</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  m_compV = computeU();</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span> (m_isTranspose)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="namespacestd.html#ad33a269e67f055aaa18f57f76b015387">std::swap</a>(m_compU, m_compV);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">if</span> (m_compU) m_naiveU = MatrixXr::Zero(m_diagSize + 1, m_diagSize + 1 );</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">else</span>         m_naiveU = MatrixXr::Zero(2, m_diagSize + 1 );</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  </div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">if</span> (m_compV) m_naiveV = MatrixXr::Zero(m_diagSize, m_diagSize);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  </div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  m_workspace.resize((m_diagSize+1)*(m_diagSize+1)*3);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  m_workspaceI.resize(3*m_diagSize);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}<span class="comment">// end allocate</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="classEigen_1_1BDCSVD.html#a52e3c627775010775c64d16a00cdb770">  238</a></span>&#160;<a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;</a>&amp; <a class="code" href="classEigen_1_1BDCSVD.html#a52e3c627775010775c64d16a00cdb770">BDCSVD&lt;MatrixType&gt;::compute</a>(<span class="keyword">const</span> <a class="code" href="classEigen_1_1BDCSVD.html#a8c3310eee662af4ca2428f7afd1472ed">MatrixType</a>&amp; <a class="code" href="common_8h.html#a94360d20ee722c1bcb23e5b2fbba8554">matrix</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions) </div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;\n\n\n======================================================================================================================\n\n\n&quot;</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  allocate(matrix.rows(), matrix.cols(), computationOptions);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">std::abs</a>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keyword">const</span> <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> considerZero = (<a class="code" href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::numeric_limits&lt;RealScalar&gt;::min</a>)();</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  </div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">//**** step -1 - If the problem is too small, directly falls back to JacobiSVD and return</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">if</span>(matrix.cols() &lt; m_algoswap)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// FIXME this line involves temporaries</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classEigen_1_1JacobiSVD.html">JacobiSVD&lt;MatrixType&gt;</a> jsvd(matrix,computationOptions);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span>(computeU()) m_matrixU = jsvd.<a class="code" href="classEigen_1_1SVDBase.html#afc7fe1546b0f6e1801b86f22f5664cb8">matrixU</a>();</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">if</span>(computeV()) m_matrixV = jsvd.<a class="code" href="classEigen_1_1SVDBase.html#a245a453b5e7347f737295c23133238c4">matrixV</a>();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    m_singularValues = jsvd.<a class="code" href="classEigen_1_1SVDBase.html#a4e7bac123570c348f7ed6be909e1e474">singularValues</a>();</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    m_nonzeroSingularValues = jsvd.<a class="code" href="classEigen_1_1SVDBase.html#afe8a555f38393a319a71ec0f0331c9ef">nonzeroSingularValues</a>();</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    m_isInitialized = <span class="keyword">true</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  </div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">//**** step 0 - Copy the input matrix and apply scaling to reduce over/under-flows</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a> = matrix.cwiseAbs().maxCoeff();</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">if</span>(scale==<a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0)) scale = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(1);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="classEigen_1_1Matrix.html">MatrixX</a> <a class="code" href="namespacenumpy.html#adb46bf70564cdd5c1175a9c6050262c8aa66f9fab761283c08285395a1a64c840">copy</a>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">if</span> (m_isTranspose) copy = matrix.adjoint()/<a class="code" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">else</span>               copy = matrix/<a class="code" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  </div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">//**** step 1 - Bidiagonalization</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">// FIXME this line involves temporaries</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="classEigen_1_1internal_1_1UpperBidiagonalization.html">internal::UpperBidiagonalization&lt;MatrixX&gt;</a> bid(copy);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">//**** step 2 - Divide &amp; Conquer</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  m_naiveU.setZero();</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  m_naiveV.setZero();</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// FIXME this line involves a temporary matrix</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  m_computed.topRows(m_diagSize) = bid.<a class="code" href="classEigen_1_1internal_1_1UpperBidiagonalization.html#a970d328a7b5fd3ad7ee9dd42c9952577">bidiagonal</a>().toDenseMatrix().transpose();</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  m_computed.template bottomRows&lt;1&gt;().<a class="code" href="Matrix__setZero__int_8cpp.html#ad232582b2296c80e793e9f17c6f5a0ab">setZero</a>();</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  divide(0, m_diagSize - 1, 0, 0, 0);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">//**** step 3 - Copy singular values and vectors</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;m_diagSize; <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="Cwise__product_8cpp.html#ad2cbe4616e813eb9af81732dca777b24">a</a> = <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(m_computed.coeff(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    m_singularValues.coeffRef(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = a * <a class="code" href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> (a&lt;considerZero)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      m_nonzeroSingularValues = <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      m_singularValues.tail(m_diagSize - <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1).setZero();</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == m_diagSize - 1)</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      m_nonzeroSingularValues = <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;m_naiveU\n&quot; &lt;&lt; m_naiveU &lt;&lt; &quot;\n\n&quot;;</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;m_naiveV\n&quot; &lt;&lt; m_naiveV &lt;&lt; &quot;\n\n&quot;;</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">if</span>(m_isTranspose) copyUV(bid.<a class="code" href="classEigen_1_1internal_1_1UpperBidiagonalization.html#a6ab970ae51909e56ceb63a49e06fdc98">householderV</a>(), bid.<a class="code" href="classEigen_1_1internal_1_1UpperBidiagonalization.html#a39887f7712de5be5a0487e9f6357b9da">householderU</a>(), m_naiveV, m_naiveU);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">else</span>              copyUV(bid.<a class="code" href="classEigen_1_1internal_1_1UpperBidiagonalization.html#a39887f7712de5be5a0487e9f6357b9da">householderU</a>(), bid.<a class="code" href="classEigen_1_1internal_1_1UpperBidiagonalization.html#a6ab970ae51909e56ceb63a49e06fdc98">householderV</a>(), m_naiveU, m_naiveV);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  m_isInitialized = <span class="keyword">true</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}<span class="comment">// end compute</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> HouseholderU, <span class="keyword">typename</span> HouseholderV, <span class="keyword">typename</span> NaiveU, <span class="keyword">typename</span> NaiveV&gt;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::copyUV</a>(<span class="keyword">const</span> HouseholderU &amp;householderU, <span class="keyword">const</span> HouseholderV &amp;householderV, <span class="keyword">const</span> NaiveU &amp;naiveU, <span class="keyword">const</span> NaiveV &amp;naiveV)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// Note exchange of U and V: m_matrixU is set from m_naiveV and vice versa</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">if</span> (computeU())</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> Ucols = m_computeThinU ? m_diagSize : householderU.<a class="code" href="classEigen_1_1SVDBase.html#a083d99e05949bab974bbff2966606b7f">cols</a>();</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    m_matrixU = MatrixX::Identity(householderU.cols(), Ucols);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    m_matrixU.topLeftCorner(m_diagSize, m_diagSize) = naiveV.template cast&lt;Scalar&gt;().<a class="code" href="class__Block_8cpp.html#a9aa86bb792a28202315593b7a0a015fd">topLeftCorner</a>(m_diagSize, m_diagSize);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    householderU.applyThisOnTheLeft(m_matrixU); <span class="comment">// FIXME this line involves a temporary buffer</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">if</span> (computeV())</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> Vcols = m_computeThinV ? m_diagSize : householderV.cols();</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    m_matrixV = MatrixX::Identity(householderV.cols(), Vcols);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    m_matrixV.topLeftCorner(m_diagSize, m_diagSize) = naiveU.template cast&lt;Scalar&gt;().<a class="code" href="class__Block_8cpp.html#a9aa86bb792a28202315593b7a0a015fd">topLeftCorner</a>(m_diagSize, m_diagSize);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    householderV.applyThisOnTheLeft(m_matrixV); <span class="comment">// FIXME this line involves a temporary buffer</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">/** \internal</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">  * Performs A = A * B exploiting the special structure of the matrix A. Splitting A as:</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">  *  A = [A1]</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">  *      [A2]</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">  * such that A1.rows()==n1, then we assume that at least half of the columns of A1 and A2 are zeros.</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">  * We can thus pack them prior to the the matrix product. However, this is only worth the effort if the matrix is large</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">  * enough.</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::structured_update</a>(<a class="code" href="classEigen_1_1Block.html">Block&lt;MatrixXr,Dynamic,Dynamic&gt;</a> <a class="code" href="classEigen_1_1Matrix.html">A</a>, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a> &amp;<a class="code" href="classEigen_1_1Matrix.html">B</a>, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> n1)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;{</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = A.rows();</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">if</span>(n&gt;100)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// If the matrices are large enough, let&#39;s exploit the sparse structure of A by</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// splitting it in half (wrt n1), and packing the non-zero columns.</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> n2 = n - n1;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="classEigen_1_1Map.html">Map&lt;MatrixXr&gt;</a> A1(m_workspace.data()      , n1, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="classEigen_1_1Map.html">Map&lt;MatrixXr&gt;</a> A2(m_workspace.data()+ n1*<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, n2, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="classEigen_1_1Map.html">Map&lt;MatrixXr&gt;</a> B1(m_workspace.data()+  n*<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>,  <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="classEigen_1_1Map.html">Map&lt;MatrixXr&gt;</a> B2(m_workspace.data()+2*n*<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>,  <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k1=0, k2=0;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0; <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">if</span>( (A.col(<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>).head(n1).array()!=<a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0)).any() )</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        A1.col(k1) = A.col(<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>).head(n1);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        B1.row(k1) = B.row(<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        ++k1;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">if</span>( (A.col(<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>).tail(n2).array()!=<a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0)).any() )</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        A2.col(k2) = A.col(<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>).tail(n2);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        B2.row(k2) = B.row(<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        ++k2;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  </div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    A.topRows(n1).noalias()    = A1.leftCols(k1) * B1.topRows(k1);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    A.bottomRows(n2).noalias() = A2.leftCols(k2) * B2.topRows(k2);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="classEigen_1_1Map.html">Map&lt;MatrixXr,Aligned&gt;</a> tmp(m_workspace.data(),<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>,<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    tmp.noalias() = A*<a class="code" href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    A = tmp;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">// The divide algorithm is done &quot;in place&quot;, we are always working on subsets of the same matrix. The divide methods takes as argument the </span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">// place of the submatrix we are currently working on.</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">//@param firstCol : The Index of the first column of the submatrix of m_computed and for m_naiveU;</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">//@param lastCol : The Index of the last column of the submatrix of m_computed and for m_naiveU; </span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">// lastCol + 1 - firstCol is the size of the submatrix.</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">//@param firstRowW : The Index of the first row of the matrix W that we are to change. (see the reference paper section 1 for more information on W)</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">//@param firstRowW : Same as firstRowW with the column.</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">//@param shift : Each time one takes the left submatrix, one must add 1 to the shift. Why? Because! We actually want the last column of the U submatrix </span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">// to become the first column (*coeff) and to shift all the other columns to the right. There are more details on the reference paper.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::divide</a> (<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> lastCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstRowW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> shift)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// requires rows = cols + 1;</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceEigen_1_1half__impl.html#a829ad00a9c93131d5a8342b4ee29d83d">std::pow</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a656b9217a2fcb6de59dc8d1eb3079cc7">std::sqrt</a>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">std::abs</a>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a> = lastCol - firstCol + 1;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k = n/2;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keyword">const</span> <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> considerZero = (<a class="code" href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::numeric_limits&lt;RealScalar&gt;::min</a>)();</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> alphaK;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> betaK; </div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> r0; </div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>, phi, c0, s0;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="classEigen_1_1Matrix.html">VectorType</a> l, f;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// We use the other algorithm which is more efficient for small </span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// matrices.</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">if</span> (n &lt; m_algoswap)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// FIXME this line involves temporaries</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="classEigen_1_1JacobiSVD.html">JacobiSVD&lt;MatrixXr&gt;</a> <a class="code" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a>(m_computed.block(firstCol, firstCol, n + 1, n), <a class="code" href="group__enums.html#ggae3e239fb70022eb8747994cf5d68b4a9a9fa9302d510cee20c26311154937e23f">ComputeFullU</a> | (m_compV ? <a class="code" href="group__enums.html#ggae3e239fb70022eb8747994cf5d68b4a9a36581f7c662f7def31efd500c284f930">ComputeFullV</a> : 0));</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (m_compU)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      m_naiveU.block(firstCol, firstCol, n + 1, n + 1).real() = b.<a class="code" href="classEigen_1_1SVDBase.html#afc7fe1546b0f6e1801b86f22f5664cb8">matrixU</a>();</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">else</span> </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      m_naiveU.row(0).segment(firstCol, n + 1).real() = b.<a class="code" href="classEigen_1_1SVDBase.html#afc7fe1546b0f6e1801b86f22f5664cb8">matrixU</a>().row(0);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      m_naiveU.row(1).segment(firstCol, n + 1).real() = b.<a class="code" href="classEigen_1_1SVDBase.html#afc7fe1546b0f6e1801b86f22f5664cb8">matrixU</a>().row(n);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (m_compV) m_naiveV.block(firstRowW, firstColW, n, n).real() = b.<a class="code" href="classEigen_1_1SVDBase.html#a245a453b5e7347f737295c23133238c4">matrixV</a>();</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    m_computed.block(firstCol + shift, firstCol + shift, n + 1, n).setZero();</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    m_computed.diagonal().segment(firstCol + shift, n) = b.<a class="code" href="classEigen_1_1SVDBase.html#a4e7bac123570c348f7ed6be909e1e474">singularValues</a>().head(n);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// We use the divide and conquer algorithm</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  alphaK =  m_computed(firstCol + k, firstCol + k);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  betaK = m_computed(firstCol + k + 1, firstCol + k);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// The divide must be done in that order in order to have good results. Divide change the data inside the submatrices</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// and the divide of the right submatrice reads one column of the left submatrice. That&#39;s why we need to treat the </span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// right submatrix before the left one. </span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  divide(k + 1 + firstCol, lastCol, k + 1 + firstRowW, k + 1 + firstColW, shift);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  divide(firstCol, k - 1 + firstCol, firstRowW, firstColW + 1, shift + 1);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">if</span> (m_compU)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    lambda = m_naiveU(firstCol + k, firstCol + k);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    phi = m_naiveU(firstCol + k + 1, lastCol + 1);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  } </div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">else</span> </div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    lambda = m_naiveU(1, firstCol + k);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    phi = m_naiveU(0, lastCol + 1);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  r0 = <a class="code" href="ArrayCwiseUnaryOps_8h.html#a656b9217a2fcb6de59dc8d1eb3079cc7">sqrt</a>((<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(alphaK * lambda) * <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(alphaK * lambda)) + <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(betaK * phi) * <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(betaK * phi));</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keywordflow">if</span> (m_compU)</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    l = m_naiveU.row(firstCol + k).segment(firstCol, k);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    f = m_naiveU.row(firstCol + k + 1).segment(firstCol + k + 1, n - k - 1);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  } </div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordflow">else</span> </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    l = m_naiveU.row(1).segment(firstCol, k);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    f = m_naiveU.row(0).segment(firstCol + k + 1, n - k - 1);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">if</span> (m_compV) m_naiveV(firstRowW+k, firstColW) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(1);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">if</span> (r0&lt;considerZero)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    c0 = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(1);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    s0 = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    c0 = alphaK * lambda / r0;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    s0 = betaK * phi / r0;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  assert(m_naiveU.allFinite());</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  assert(m_naiveV.allFinite());</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  assert(m_computed.allFinite());</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  </div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">if</span> (m_compU)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a> q1 (m_naiveU.col(firstCol + k).segment(firstCol, k + 1));     </div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">// we shiftW Q1 to the right</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = firstCol + k - 1; <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= firstCol; <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>--) </div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      m_naiveU.col(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1).segment(firstCol, k + 1) = m_naiveU.col(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>).segment(firstCol, k + 1);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// we shift q1 at the left with a factor c0</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    m_naiveU.col(firstCol).segment( firstCol, k + 1) = (q1 * c0);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// last column = q1 * - s0</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    m_naiveU.col(lastCol + 1).segment(firstCol, k + 1) = (q1 * ( - s0));</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// first column = q2 * s0</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    m_naiveU.col(firstCol).segment(firstCol + k + 1, n - k) = m_naiveU.col(lastCol + 1).segment(firstCol + k + 1, n - k) * s0; </div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// q2 *= c0</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    m_naiveU.col(lastCol + 1).segment(firstCol + k + 1, n - k) *= c0;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  } </div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">else</span> </div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> q1 = m_naiveU(0, firstCol + k);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// we shift Q1 to the right</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = firstCol + k - 1; <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= firstCol; <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>--) </div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      m_naiveU(0, <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1) = m_naiveU(0, <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// we shift q1 at the left with a factor c0</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    m_naiveU(0, firstCol) = (q1 * c0);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// last column = q1 * - s0</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    m_naiveU(0, lastCol + 1) = (q1 * ( - s0));</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// first column = q2 * s0</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    m_naiveU(1, firstCol) = m_naiveU(1, lastCol + 1) *s0; </div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// q2 *= c0</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    m_naiveU(1, lastCol + 1) *= c0;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    m_naiveU.row(1).segment(firstCol + 1, k).setZero();</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    m_naiveU.row(0).segment(firstCol + k + 1, n - k - 1).setZero();</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  </div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  assert(m_naiveU.allFinite());</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  assert(m_naiveV.allFinite());</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  assert(m_computed.allFinite());</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  </div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  m_computed(firstCol + shift, firstCol + shift) = r0;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  m_computed.col(firstCol + shift).segment(firstCol + shift + 1, k) = alphaK * l.transpose().real();</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  m_computed.col(firstCol + shift).segment(firstCol + shift + k + 1, n - k - 1) = betaK * f.transpose().real();</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <a class="code" href="classEigen_1_1Array.html">ArrayXr</a> tmp1 = (m_computed.block(firstCol+shift, firstCol+shift, n, n)).jacobiSvd().singularValues();</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// Second part: try to deflate singular values in combined matrix</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  deflation(firstCol, lastCol, k, firstRowW, firstColW, shift);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <a class="code" href="classEigen_1_1Array.html">ArrayXr</a> tmp2 = (m_computed.block(firstCol+shift, firstCol+shift, n, n)).jacobiSvd().singularValues();</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;\n\nj1 = &quot;</span> &lt;&lt; tmp1.transpose().format(bdcsvdfmt) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;j2 = &quot;</span> &lt;&lt; tmp2.transpose().format(bdcsvdfmt) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;err:      &quot;</span> &lt;&lt; ((tmp1-tmp2).<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>()&gt;1<a class="code" href="Cwise__array__power__array_8cpp.html#aa9e3025f5efca2c2a39d785652f2d710">e</a>-12*tmp2.abs()).transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; ++count &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  assert((tmp1-tmp2).<a class="code" href="common_8h.html#a94360d20ee722c1bcb23e5b2fbba8554">matrix</a>().norm() &lt; 1<a class="code" href="Cwise__array__power__array_8cpp.html#aa9e3025f5efca2c2a39d785652f2d710">e</a>-14*tmp2.matrix().norm());</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">//   assert(count&lt;681);</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">//   assert(((tmp1-tmp2).abs()&lt;1e-13*tmp2.abs()).all());</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  </div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// Third part: compute SVD of combined matrix</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a> UofSVD, VofSVD;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <a class="code" href="classEigen_1_1Matrix.html">VectorType</a> singVals;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  computeSVDofM(firstCol + shift, n, UofSVD, singVals, VofSVD);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  assert(UofSVD.allFinite());</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  assert(VofSVD.allFinite());</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  </div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">if</span> (m_compU)</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    structured_update(m_naiveU.block(firstCol, firstCol, n + 1, n + 1), UofSVD, (n+2)/2);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="classEigen_1_1Map.html">Map&lt;Matrix&lt;RealScalar,2,Dynamic&gt;</a>,<a class="code" href="group__enums.html#gga45fe06e29902b7a2773de05ba27b47a1ae12d0f8f869c40c76128260af2242bc8">Aligned</a>&gt; tmp(m_workspace.data(),2,n+1);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    tmp.noalias() = m_naiveU.middleCols(firstCol, n+1) * UofSVD;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    m_naiveU.middleCols(firstCol, n + 1) = tmp;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  </div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordflow">if</span> (m_compV)  structured_update(m_naiveV.block(firstRowW, firstColW, n, n), VofSVD, (n+1)/2);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  assert(m_naiveU.allFinite());</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  assert(m_naiveV.allFinite());</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  assert(m_computed.allFinite());</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  m_computed.block(firstCol + shift, firstCol + shift, n, n).setZero();</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  m_computed.block(firstCol + shift, firstCol + shift, n, n).diagonal() = singVals;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;}<span class="comment">// end divide</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">// Compute SVD of m_computed.block(firstCol, firstCol, n + 1, n); this block only has non-zeros in</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">// the first column and on the diagonal and has undergone deflation, so diagonal is in increasing</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">// order except for possibly the (0,0) entry. The computed SVD is stored U, singVals and V, except</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">// that if m_compV is false, then V is not computed. Singular values are sorted in decreasing order.</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">// TODO Opportunities for optimization: better root finding algo, better stopping criterion, better</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">// handling of round-off errors, be consistent in ordering</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">// For instance, to solve the secular equation using FMM, see http://www.stat.uchicago.edu/~lekheng/courses/302/classics/greengard-rokhlin.pdf</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::computeSVDofM</a>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a>&amp; U, <a class="code" href="classEigen_1_1Matrix.html">VectorType</a>&amp; singVals, <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a>&amp; <a class="code" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>)</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;{</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keyword">const</span> <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> considerZero = (<a class="code" href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::numeric_limits&lt;RealScalar&gt;::min</a>)();</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">std::abs</a>;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a> col0 = m_computed.col(firstCol).segment(firstCol, n);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  m_workspace.head(n) =  m_computed.block(firstCol, firstCol, n, n).diagonal();</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a> diag = m_workspace.head(n);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  diag(0) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">// Allocate space for singular values and vectors</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  singVals.<a class="code" href="classEigen_1_1PlainObjectBase.html#a99d9054ee2d5a40c6e00ded0265e9cea">resize</a>(n);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  U.<a class="code" href="classEigen_1_1PlainObjectBase.html#a99d9054ee2d5a40c6e00ded0265e9cea">resize</a>(n+1, n+1);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span> (m_compV) V.<a class="code" href="classEigen_1_1PlainObjectBase.html#a99d9054ee2d5a40c6e00ded0265e9cea">resize</a>(n, n);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">if</span> (col0.hasNaN() || diag.hasNaN())</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;\n\nHAS NAN\n\n&quot;</span>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  </div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// Many singular values might have been deflated, the zero ones have been moved to the end,</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">// but others are interleaved and we must ignore them at this stage.</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">// To this end, let&#39;s compute a permutation skipping them:</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> actual_n = <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordflow">while</span>(actual_n&gt;1 &amp;&amp; diag(actual_n-1)==<a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0)) --actual_n;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a> = 0; <span class="comment">// size of the deflated problem</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k=0;k&lt;actual_n;++k)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(col0(k))&gt;considerZero)</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      m_workspaceI(m++) = k;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <a class="code" href="classEigen_1_1Map.html">Map&lt;ArrayXi&gt;</a> perm(m_workspaceI.data(),<a class="code" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  </div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <a class="code" href="classEigen_1_1Map.html">Map&lt;ArrayXr&gt;</a> shifts(m_workspace.data()+1*<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="classEigen_1_1Map.html">Map&lt;ArrayXr&gt;</a> mus(m_workspace.data()+2*<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <a class="code" href="classEigen_1_1Map.html">Map&lt;ArrayXr&gt;</a> zhat(m_workspace.data()+3*<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;computeSVDofM using:\n&quot;</span>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;  z: &quot;</span> &lt;&lt; col0.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;  d: &quot;</span> &lt;&lt; diag.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  </div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">// Compute singVals, shifts, and mus</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  computeSingVals(col0, diag, perm, singVals, shifts, mus);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;  j:        &quot;</span> &lt;&lt; (m_computed.block(firstCol, firstCol, n, n)).jacobiSvd().singularValues().transpose().reverse() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;  sing-val: &quot;</span> &lt;&lt; singVals.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;  mu:       &quot;</span> &lt;&lt; mus.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;  shift:    &quot;</span> &lt;&lt; shifts.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> actual_n = <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">while</span>(actual_n&gt;1 &amp;&amp; <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(col0(actual_n-1))&lt;considerZero) --actual_n;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;\n\n    mus:    &quot;</span> &lt;&lt; mus.head(actual_n).transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;    check1 (expect0) : &quot;</span> &lt;&lt; ((singVals.array()-(shifts+mus)) / singVals.array()).<a class="code" href="BlockMethods_8h.html#a9195fdd59174bd73125c79f2ca38b392">head</a>(actual_n).transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;    check2 (&gt;0)      : &quot;</span> &lt;&lt; ((singVals.array()-diag) / singVals.array()).<a class="code" href="BlockMethods_8h.html#a9195fdd59174bd73125c79f2ca38b392">head</a>(actual_n).transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;    check3 (&gt;0)      : &quot;</span> &lt;&lt; ((diag.segment(1,actual_n-1)-singVals.head(actual_n-1).array()) / singVals.head(actual_n-1).array()).transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n\n&quot;</span>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;    check4 (&gt;0)      : &quot;</span> &lt;&lt; ((singVals.segment(1,actual_n-1)-singVals.head(actual_n-1))).transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n\n&quot;</span>;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  assert(singVals.allFinite());</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  assert(mus.allFinite());</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  assert(shifts.allFinite());</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  </div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="comment">// Compute zhat</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  perturbCol0(col0, diag, perm, singVals, shifts, mus, zhat);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;  zhat: &quot;</span> &lt;&lt; zhat.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  </div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  assert(zhat.allFinite());</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  </div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  computeSingVecs(zhat, diag, perm, singVals, shifts, mus, U, V);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  </div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;U^T U: &quot;</span> &lt;&lt; (U.transpose() * U - <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a>(MatrixXr::Identity(U.<a class="code" href="classEigen_1_1PlainObjectBase.html#a10b8b33b7587da564415561aa246f78f">cols</a>(),U.<a class="code" href="classEigen_1_1PlainObjectBase.html#a10b8b33b7587da564415561aa246f78f">cols</a>()))).norm() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;V^T V: &quot;</span> &lt;&lt; (V.transpose() * V - <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a>(MatrixXr::Identity(V.<a class="code" href="classEigen_1_1PlainObjectBase.html#a10b8b33b7587da564415561aa246f78f">cols</a>(),V.<a class="code" href="classEigen_1_1PlainObjectBase.html#a10b8b33b7587da564415561aa246f78f">cols</a>()))).norm() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  assert(U.allFinite());</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  assert(V.allFinite());</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  assert((U.transpose() * U - <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a>(MatrixXr::Identity(U.<a class="code" href="classEigen_1_1PlainObjectBase.html#a10b8b33b7587da564415561aa246f78f">cols</a>(),U.<a class="code" href="classEigen_1_1PlainObjectBase.html#a10b8b33b7587da564415561aa246f78f">cols</a>()))).norm() &lt; 1<a class="code" href="Cwise__array__power__array_8cpp.html#aa9e3025f5efca2c2a39d785652f2d710">e</a>-14 * <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  assert((V.transpose() * V - <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a>(MatrixXr::Identity(V.<a class="code" href="classEigen_1_1PlainObjectBase.html#a10b8b33b7587da564415561aa246f78f">cols</a>(),V.<a class="code" href="classEigen_1_1PlainObjectBase.html#a10b8b33b7587da564415561aa246f78f">cols</a>()))).norm() &lt; 1<a class="code" href="Cwise__array__power__array_8cpp.html#aa9e3025f5efca2c2a39d785652f2d710">e</a>-14 * <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  assert(m_naiveU.allFinite());</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  assert(m_naiveV.allFinite());</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  assert(m_computed.allFinite());</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  </div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// Because of deflation, the singular values might not be completely sorted.</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">// Fortunately, reordering them is a O(n) problem</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;actual_n-1; ++<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">if</span>(singVals(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)&gt;singVals(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1))</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keyword">using</span> <a class="code" href="namespacestd.html#ad33a269e67f055aaa18f57f76b015387">std::swap</a>;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <a class="code" href="namespaceEigen_1_1internal.html#aefb14fc87518cc6b91063a820a66a21b">swap</a>(singVals(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),singVals(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1));</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      U.col(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classEigen_1_1PlainObjectBase.html#aa86254240c534cc55143f38af58c8bdf">swap</a>(U.col(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1));</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">if</span>(m_compV) V.col(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classEigen_1_1PlainObjectBase.html#aa86254240c534cc55143f38af58c8bdf">swap</a>(V.col(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1));</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  </div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">// Reverse order so that singular values in increased order</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="comment">// Because of deflation, the zeros singular-values are already at the end</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  singVals.head(actual_n).reverseInPlace();</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  U.leftCols(actual_n).rowwise().reverseInPlace();</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">if</span> (m_compV) V.leftCols(actual_n).rowwise().reverseInPlace();</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  </div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <a class="code" href="classEigen_1_1JacobiSVD.html">JacobiSVD&lt;MatrixXr&gt;</a> jsvd(m_computed.block(firstCol, firstCol, n, n) );</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;  * j:        &quot;</span> &lt;&lt; jsvd.singularValues().transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;  * sing-val: &quot;</span> &lt;&lt; singVals.transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;  * err:      &quot; &lt;&lt; ((jsvd.singularValues()-singVals)&gt;1e-13*singVals.norm()).transpose() &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keyword">typename</span> <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">BDCSVD&lt;MatrixType&gt;::RealScalar</a> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::secularEq</a>(<a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> mu, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; col0, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; diag, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">IndicesRef</a> &amp;perm, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; diagShifted, <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> shift)</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;{</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a> = perm.size();</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a> = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(1);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>; ++<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = perm(<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    res += <a class="code" href="ArrayCwiseUnaryOps_8h.html#a4921dbe62d034394f6fa7810e8711356">numext::abs2</a>(col0(j)) / ((diagShifted(j) - mu) * (diag(j) + shift + mu));</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;}</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::computeSingVals</a>(<span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; col0, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; diag, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">IndicesRef</a> &amp;perm,</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                         <a class="code" href="classEigen_1_1Matrix.html">VectorType</a>&amp; singVals, <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a> shifts, <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a> mus)</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;{</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">std::abs</a>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacestd.html#ad33a269e67f055aaa18f57f76b015387">std::swap</a>;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> n = col0.size();</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> actual_n = <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordflow">while</span>(actual_n&gt;1 &amp;&amp; col0(actual_n-1)==<a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0)) --actual_n;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k = 0; k &lt; <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++k)</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">if</span> (col0(k) == <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0) || actual_n==1)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="comment">// if col0(k) == 0, then entry is deflated, so singular value is on diagonal</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="comment">// if actual_n==1, then the deflated problem is already diagonalized</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      singVals(k) = k==0 ? col0(0) : diag(k);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      mus(k) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      shifts(k) = k==0 ? col0(0) : diag(k);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    } </div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">// otherwise, use secular equation to find singular value</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> left = diag(k);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> right; <span class="comment">// was: = (k != actual_n-1) ? diag(k+1) : (diag(actual_n-1) + col0.matrix().norm());</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">if</span>(k==actual_n-1)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      right = (diag(actual_n-1) + col0.matrix().norm());</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="comment">// Skip deflated singular values</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> l = k+1;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">while</span>(col0(l)==<a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0)) { ++l; <a class="code" href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a>(l&lt;actual_n); }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      right = diag(l);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">// first decide whether it&#39;s closer to the left end or the right end</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> mid = left + (right-left) / <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(2);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> fMid = secularEq(mid, col0, diag, perm, diag, <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0));</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    std::cout &lt;&lt; right-left &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;fMid = &quot;</span> &lt;&lt; fMid &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; secularEq(mid-left, col0, diag, perm, diag-left, left) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; secularEq(mid-right, col0, diag, perm, diag-right, right)   &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;     = &quot;</span> &lt;&lt; secularEq(0.1*(left+right), col0, diag, perm, diag, 0)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(0.2*(left+right), col0, diag, perm, diag, 0)</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(0.3*(left+right), col0, diag, perm, diag, 0)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(0.4*(left+right), col0, diag, perm, diag, 0)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(0.49*(left+right), col0, diag, perm, diag, 0)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(0.5*(left+right), col0, diag, perm, diag, 0)</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(0.51*(left+right), col0, diag, perm, diag, 0)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(0.6*(left+right), col0, diag, perm, diag, 0)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(0.7*(left+right), col0, diag, perm, diag, 0)</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(0.8*(left+right), col0, diag, perm, diag, 0)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span>       &lt;&lt; secularEq(0.9*(left+right), col0, diag, perm, diag, 0) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> shift = (k == actual_n-1 || fMid &gt; <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0)) ? left : right;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    </div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">// measure everything relative to shift</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="classEigen_1_1Map.html">Map&lt;ArrayXr&gt;</a> diagShifted(m_workspace.data()+4*<a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>, <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    diagShifted = diag - shift;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    </div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">// initial guess</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> muPrev, muCur;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">if</span> (shift == left)</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      muPrev = (right - left) * <a class="code" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.1);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="keywordflow">if</span> (k == actual_n-1) muCur = right - left;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keywordflow">else</span>                 muCur = (right - left) * <a class="code" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.5);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    }</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      muPrev = -(right - left) * <a class="code" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.1);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      muCur = -(right - left) * <a class="code" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.5);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> fPrev = secularEq(muPrev, col0, diag, perm, diagShifted, shift);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> fCur = secularEq(muCur, col0, diag, perm, diagShifted, shift);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(fPrev) &lt; <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(fCur))</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <a class="code" href="namespaceEigen_1_1internal.html#aefb14fc87518cc6b91063a820a66a21b">swap</a>(fPrev, fCur);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <a class="code" href="namespaceEigen_1_1internal.html#aefb14fc87518cc6b91063a820a66a21b">swap</a>(muPrev, muCur);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">// rational interpolation: fit a function of the form a / mu + b through the two previous</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">// iterates and use its zero to compute the next iterate</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">bool</span> useBisection = fPrev*fCur&gt;<a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">while</span> (fCur!=Literal(0) &amp;&amp; <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(muCur - muPrev) &gt; Literal(8) * <a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;RealScalar&gt;::epsilon</a>() * numext::maxi&lt;RealScalar&gt;(<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(muCur), <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(muPrev)) &amp;&amp; <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(fCur - fPrev)&gt;<a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;RealScalar&gt;::epsilon</a>() &amp;&amp; !useBisection)</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    {</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      ++m_numIters;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="comment">// Find a and b such that the function f(mu) = a / mu + b matches the current and previous samples.</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="Cwise__product_8cpp.html#ad2cbe4616e813eb9af81732dca777b24">a</a> = (fCur - fPrev) / (Literal(1)/muCur - Literal(1)/muPrev);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a> = fCur - a / muCur;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="comment">// And find mu such that f(mu)==0:</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> muZero = -a/<a class="code" href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> fZero = secularEq(muZero, col0, diag, perm, diagShifted, shift);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      </div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      muPrev = muCur;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      fPrev = fCur;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      muCur = muZero;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      fCur = fZero;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      </div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      </div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">if</span> (shift == left  &amp;&amp; (muCur &lt; Literal(0) || muCur &gt; right - left)) useBisection = <span class="keyword">true</span>;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">if</span> (shift == right &amp;&amp; (muCur &lt; -(right - left) || muCur &gt; Literal(0))) useBisection = <span class="keyword">true</span>;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(fCur)&gt;<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(fPrev)) useBisection = <span class="keyword">true</span>;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">// fall back on bisection method if rational interpolation did not work</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">if</span> (useBisection)</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;useBisection for k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, actual_n = &quot;</span> &lt;&lt; actual_n &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> leftShifted, rightShifted;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">if</span> (shift == left)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        leftShifted = (<a class="code" href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::numeric_limits&lt;RealScalar&gt;::min</a>)();</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="comment">// I don&#39;t understand why the case k==0 would be special there:</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="comment">// if (k == 0) rightShifted = right - left; else </span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        rightShifted = (k==actual_n-1) ? right : ((right - left) * <a class="code" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.6)); <span class="comment">// theoretically we can take 0.5, but let&#39;s be safe</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      }</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      {</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        leftShifted = -(right - left) * <a class="code" href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a>(0.6);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        rightShifted = -(<a class="code" href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::numeric_limits&lt;RealScalar&gt;::min</a>)();</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> fLeft = secularEq(leftShifted, col0, diag, perm, diagShifted, shift);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="preprocessor">#if defined EIGEN_INTERNAL_DEBUGGING || defined EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> fRight = secularEq(rightShifted, col0, diag, perm, diagShifted, shift);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keywordflow">if</span>(!(fLeft * fRight&lt;0))</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;fLeft: &quot;</span> &lt;&lt; leftShifted &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; diagShifted.head(10).transpose()  &lt;&lt; <span class="stringliteral">&quot;\n ; &quot;</span> &lt;&lt; <a class="code" href="classbool.html">bool</a>(left==shift) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (left-shift) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        std::cout &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt;  fLeft &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; fRight &lt;&lt; <span class="stringliteral">&quot; == &quot;</span> &lt;&lt; fLeft * fRight &lt;&lt; <span class="stringliteral">&quot;  ;  &quot;</span> &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; right &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt;  leftShifted &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; rightShifted &lt;&lt; <span class="stringliteral">&quot;   shift=&quot;</span> &lt;&lt; shift &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      }</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <a class="code" href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a>(fLeft * fRight &lt; Literal(0));</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      </div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keywordflow">while</span> (rightShifted - leftShifted &gt; Literal(2) * <a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;RealScalar&gt;::epsilon</a>() * numext::maxi&lt;RealScalar&gt;(<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(leftShifted), <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(rightShifted)))</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> midShifted = (leftShifted + rightShifted) / Literal(2);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        fMid = secularEq(midShifted, col0, diag, perm, diagShifted, shift);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">if</span> (fLeft * fMid &lt; Literal(0))</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;          rightShifted = midShifted;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;          leftShifted = midShifted;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;          fLeft = fMid;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      }</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      muCur = (leftShifted + rightShifted) / Literal(2);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      </div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    singVals[k] = shift + muCur;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    shifts[k] = shift;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    mus[k] = muCur;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// perturb singular value slightly if it equals diagonal entry to avoid division by zero later</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// (deflation is supposed to avoid this from happening)</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">// - this does no seem to be necessary anymore -</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">//     if (singVals[k] == left) singVals[k] *= 1 + NumTraits&lt;RealScalar&gt;::epsilon();</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">//     if (singVals[k] == right) singVals[k] *= 1 - NumTraits&lt;RealScalar&gt;::epsilon();</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  }</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;}</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">// zhat is perturbation of col0 for which singular vectors can be computed stably (see Section 3.1)</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::perturbCol0</a></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;   (<span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; col0, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; diag, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">IndicesRef</a> &amp;perm, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Matrix.html">VectorType</a>&amp; singVals,</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; shifts, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; mus, <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a> zhat)</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;{</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a656b9217a2fcb6de59dc8d1eb3079cc7">std::sqrt</a>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> n = col0.size();</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a> = perm.size();</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">if</span>(m==0)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    zhat.setZero();</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> last = perm(m-1);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="comment">// The offset permits to skip deflated entries while computing zhat</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k = 0; k &lt; <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++k)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  {</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span> (col0(k) == <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0)) <span class="comment">// deflated</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      zhat(k) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    {</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="comment">// see equation (3.6)</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> dk = diag(k);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="namespaceEigen.html#a368a2930040572f113bc1278a6e4f0be">prod</a> = (singVals(last) + dk) * (mus(last) + (shifts(last) - dk));</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> l = 0; l&lt;<a class="code" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>; ++l)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      {</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = perm(l);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">if</span>(i!=k)</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;          <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = i&lt;k ? <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> : perm(l-1);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          prod *= ((singVals(j)+dk) / ((diag(i)+dk))) * ((mus(j)+(shifts(j)-dk)) / ((diag(i)-dk)));</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;          <span class="keywordflow">if</span>(i!=k &amp;&amp; <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">std::abs</a>(((singVals(j)+dk)*(mus(j)+(shifts(j)-dk)))/((diag(i)+dk)*(diag(i)-dk)) - 1) &gt; 0.9 )</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; ((singVals(j)+dk)*(mus(j)+(shifts(j)-dk)))/((diag(i)+dk)*(diag(i)-dk)) &lt;&lt; <span class="stringliteral">&quot; == (&quot;</span> &lt;&lt; (singVals(j)+dk) &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; (mus(j)+(shifts(j)-dk))</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;) / (&quot;</span> &lt;&lt; (diag(i)+dk) &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; (diag(i)-dk) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;zhat(&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;) =  sqrt( &quot;</span> &lt;&lt; prod &lt;&lt; <span class="stringliteral">&quot;)  ;  &quot;</span> &lt;&lt; (singVals(last) + dk) &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; mus(last) + shifts(last) &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; dk &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> tmp = <a class="code" href="ArrayCwiseUnaryOps_8h.html#a656b9217a2fcb6de59dc8d1eb3079cc7">sqrt</a>(prod);</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      zhat(k) = col0(k) &gt; <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0) ? tmp : -tmp;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;}</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">// compute singular vectors</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::computeSingVecs</a></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   (<span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; zhat, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; diag, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">IndicesRef</a> &amp;perm, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Matrix.html">VectorType</a>&amp; singVals,</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; shifts, <span class="keyword">const</span> <a class="code" href="classEigen_1_1Ref.html">ArrayRef</a>&amp; mus, <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a>&amp; U, <a class="code" href="classEigen_1_1Matrix.html">MatrixXr</a>&amp; V)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;{</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> n = zhat.size();</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a> = perm.size();</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  </div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k = 0; k &lt; <a class="code" href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a>; ++k)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (zhat(k) == <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0))</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      U.col(k) = VectorType::Unit(n+1, k);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="keywordflow">if</span> (m_compV) V.col(k) = VectorType::Unit(n, k);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      U.col(k).<a class="code" href="classEigen_1_1PlainObjectBase.html#ac21ad5f989f320e46958b75ac8d9a1da">setZero</a>();</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> l=0;l&lt;<a class="code" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>;++l)</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = perm(l);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        U(i,k) = zhat(i)/(((diag(i) - shifts(k)) - mus(k)) )/( (diag(i) + singVals[k]));</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      U(n,k) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      U.col(k).normalize();</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    </div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">if</span> (m_compV)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      {</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        V.col(k).<a class="code" href="classEigen_1_1PlainObjectBase.html#ac21ad5f989f320e46958b75ac8d9a1da">setZero</a>();</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> l=1;l&lt;<a class="code" href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>;++l)</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;          <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = perm(l);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;          <a class="code" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>(i,k) = diag(i) * zhat(i) / (((diag(i) - shifts(k)) - mus(k)) )/( (diag(i) + singVals[k]));</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        }</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <a class="code" href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a>(0,k) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(-1);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        V.col(k).normalize();</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    }</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  }</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  U.col(n) = VectorType::Unit(n+1, n);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;}</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">// page 12_13</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">// i &gt;= 1, di almost null and zi non null.</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">// We use a rotation to zero out zi applied to the left of M</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::deflation43</a>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> shift, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="benchVecAdd_8cpp.html#acc017e1f28bf1b83809251a830f315c3">size</a>)</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;{</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">std::abs</a>;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a656b9217a2fcb6de59dc8d1eb3079cc7">std::sqrt</a>;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceEigen_1_1half__impl.html#a829ad00a9c93131d5a8342b4ee29d83d">std::pow</a>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> start = firstCol + shift;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a> = m_computed(start, start);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a> = m_computed(start+i, start);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> r = <a class="code" href="ArrayCwiseUnaryOps_8h.html#a656b9217a2fcb6de59dc8d1eb3079cc7">sqrt</a>(<a class="code" href="ArrayCwiseUnaryOps_8h.html#a4921dbe62d034394f6fa7810e8711356">numext::abs2</a>(c) + <a class="code" href="ArrayCwiseUnaryOps_8h.html#a4921dbe62d034394f6fa7810e8711356">numext::abs2</a>(s));</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="keywordflow">if</span> (r == <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0))</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  {</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    m_computed(start+i, start+i) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  m_computed(start,start) = r;  </div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  m_computed(start+i, start) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  m_computed(start+i, start+i) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  </div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <a class="code" href="classEigen_1_1JacobiRotation.html">JacobiRotation&lt;RealScalar&gt;</a> <a class="code" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>(c/r,-s/r);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="keywordflow">if</span> (m_compU)  m_naiveU.middleRows(firstCol, size+1).applyOnTheRight(firstCol, firstCol+i, J);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">else</span>          m_naiveU.applyOnTheRight(firstCol, firstCol+i, J);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;}<span class="comment">// end deflation 43</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">// page 13</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">// i,j &gt;= 1, i!=j and |di - dj| &lt; epsilon * norm2(M)</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">// We apply two rotations to have zj = 0;</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">// TODO deflation44 is still broken and not properly tested</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::deflation44</a>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColu , <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColm, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstRowW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> i, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> size)</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;{</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">std::abs</a>;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a656b9217a2fcb6de59dc8d1eb3079cc7">std::sqrt</a>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="keyword">using</span> <a class="code" href="exceptions_8cpp.html#a75f785bf0f51cbc94279c80d143642ae">std::conj</a>;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceEigen_1_1half__impl.html#a829ad00a9c93131d5a8342b4ee29d83d">std::pow</a>;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a> = m_computed(firstColm+i, firstColm);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> <a class="code" href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a> = m_computed(firstColm+j, firstColm);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> r = <a class="code" href="ArrayCwiseUnaryOps_8h.html#a656b9217a2fcb6de59dc8d1eb3079cc7">sqrt</a>(<a class="code" href="ArrayCwiseUnaryOps_8h.html#a4921dbe62d034394f6fa7810e8711356">numext::abs2</a>(c) + <a class="code" href="ArrayCwiseUnaryOps_8h.html#a4921dbe62d034394f6fa7810e8711356">numext::abs2</a>(s));</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;deflation 4.4: &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    &lt;&lt; m_computed(firstColm + i-1, firstColm)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    &lt;&lt; m_computed(firstColm + i, firstColm)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    &lt;&lt; m_computed(firstColm + i+1, firstColm) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    &lt;&lt; m_computed(firstColm + i+2, firstColm) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  std::cout &lt;&lt; m_computed(firstColm + i-1, firstColm + i-1)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    &lt;&lt; m_computed(firstColm + i, firstColm+i)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    &lt;&lt; m_computed(firstColm + i+1, firstColm+i+1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    &lt;&lt; m_computed(firstColm + i+2, firstColm+i+2) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="keywordflow">if</span> (r==<a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0))</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    m_computed(firstColm + i, firstColm + i) = m_computed(firstColm + j, firstColm + j);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  }</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  c/=r;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  s/=r;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  m_computed(firstColm + i, firstColm) = r;  </div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  m_computed(firstColm + j, firstColm + j) = m_computed(firstColm + i, firstColm + i);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  m_computed(firstColm + j, firstColm) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <a class="code" href="classEigen_1_1JacobiRotation.html">JacobiRotation&lt;RealScalar&gt;</a> <a class="code" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>(c,-s);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordflow">if</span> (m_compU)  m_naiveU.middleRows(firstColu, size+1).applyOnTheRight(firstColu + i, firstColu + j, J);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="keywordflow">else</span>          m_naiveU.applyOnTheRight(firstColu+i, firstColu+j, J);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keywordflow">if</span> (m_compV)  m_naiveV.middleRows(firstRowW, size).applyOnTheRight(firstColW + i, firstColW + j, J);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;}<span class="comment">// end deflation 44</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">// acts on block from (firstCol+shift, firstCol+shift) to (lastCol+shift, lastCol+shift) [inclusive]</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType&gt;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;MatrixType&gt;::deflation</a>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> lastCol, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> k, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstRowW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> firstColW, <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> shift)</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;{</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a656b9217a2fcb6de59dc8d1eb3079cc7">std::sqrt</a>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="keyword">using</span> <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">std::abs</a>;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> length = lastCol + 1 - firstCol;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  </div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <a class="code" href="classEigen_1_1Block.html">Block&lt;MatrixXr,Dynamic,1&gt;</a> col0(m_computed, firstCol+shift, firstCol+shift, length, 1);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <a class="code" href="classEigen_1_1Diagonal.html">Diagonal&lt;MatrixXr&gt;</a> fulldiag(m_computed);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <a class="code" href="classEigen_1_1VectorBlock.html">VectorBlock&lt;Diagonal&lt;MatrixXr&gt;</a>,<a class="code" href="namespaceEigen.html#ad81fa7195215a0ce30017dfac309f0b2">Dynamic</a>&gt; diag(fulldiag, firstCol+shift, length);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  </div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keyword">const</span> <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> considerZero = (<a class="code" href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::numeric_limits&lt;RealScalar&gt;::min</a>)();</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> maxDiag = diag.tail((<a class="code" href="datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>)(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a>(1),length-1)).cwiseAbs().maxCoeff();</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> epsilon_strict = numext::maxi&lt;RealScalar&gt;(considerZero,<a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;RealScalar&gt;::epsilon</a>() * maxDiag);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <a class="code" href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">RealScalar</a> epsilon_coarse = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(8) * <a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;RealScalar&gt;::epsilon</a>() * numext::maxi&lt;RealScalar&gt;(col0.cwiseAbs().maxCoeff(), maxDiag);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  </div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  assert(m_naiveU.allFinite());</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  assert(m_naiveV.allFinite());</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  assert(m_computed.allFinite());</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE  </span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;\ndeflate:&quot;</span> &lt;&lt; diag.head(k+1).transpose() &lt;&lt; <span class="stringliteral">&quot;  |  &quot;</span> &lt;&lt; diag.segment(k+1,length-k-1).transpose() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  </div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="comment">//condition 4.1</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">if</span> (diag(0) &lt; epsilon_coarse)</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  { </div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;deflation 4.1, because &quot;</span> &lt;&lt; diag(0) &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span> &lt;&lt; epsilon_coarse &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    diag(0) = epsilon_coarse;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  }</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="comment">//condition 4.2</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> i=1;i&lt;length;++<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(col0(i)) &lt; epsilon_strict)</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    {</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;deflation 4.2, set z(&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;) to zero because &quot;</span> &lt;&lt; <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(col0(i)) &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span> &lt;&lt; epsilon_strict &lt;&lt; <span class="stringliteral">&quot;  (diag(&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span> &lt;&lt; diag(i) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      col0(i) = <a class="code" href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Literal</a>(0);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    }</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="comment">//condition 4.3</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> i=1;i&lt;length; i++)</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">if</span> (diag(i) &lt; epsilon_coarse)</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    {</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="preprocessor">#ifdef  EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;deflation 4.3, cancel z(&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span> &lt;&lt; col0(i) &lt;&lt; <span class="stringliteral">&quot; because diag(&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span> &lt;&lt; diag(i) &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span> &lt;&lt; epsilon_coarse &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      deflation43(firstCol, shift, i, length);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    }</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  assert(m_naiveU.allFinite());</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  assert(m_naiveV.allFinite());</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  assert(m_computed.allFinite());</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;to be sorted: &quot;</span> &lt;&lt; diag.transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">// Check for total deflation</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="comment">// If we have a total deflation, then we have to consider col0(0)==diag(0) as a singular value during sorting</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordtype">bool</span> total_deflation = (col0.tail(length-1).array()&lt;considerZero).all();</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    </div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="comment">// Sort the diagonal entries, since diag(1:k-1) and diag(k:length) are already sorted, let&#39;s do a sorted merge.</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">// First, compute the respective permutation.</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> *permutation = m_workspaceI.data();</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    {</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      permutation[0] = 0;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 1;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      </div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="comment">// Move deflated diagonal entries at the end.</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> i=1; i&lt;length; ++<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(diag(i))&lt;considerZero)</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;          permutation[p++] = <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        </div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> i=1, j=k+1;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="keywordflow">for</span>( ; p &lt; length; ++<a class="code" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>)</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;             <span class="keywordflow">if</span> (i &gt; k)             permutation[<a class="code" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = j++;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j &gt;= length)       permutation[<a class="code" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = i++;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (diag(i) &lt; diag(j)) permutation[<a class="code" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = j++;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="keywordflow">else</span>                        permutation[<a class="code" href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = i++;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      }</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    }</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    </div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="comment">// If we have a total deflation, then we have to insert diag(0) at the right place</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">if</span>(total_deflation)</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    {</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> i=1; i&lt;length; ++<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      {</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> pi = permutation[<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(diag(pi))&lt;considerZero || diag(0)&lt;diag(pi))</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;          permutation[i-1] = permutation[<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        {</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          permutation[i-1] = 0;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      }</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    }</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    </div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="comment">// Current index of each col, and current column of each index</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> *realInd = m_workspaceI.data()+length;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> *realCol = m_workspaceI.data()+2*length;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    </div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> pos = 0; pos&lt; length; pos++)</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      realCol[pos] = pos;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      realInd[pos] = pos;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    }</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    </div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> i = total_deflation?0:1; i &lt; length; i++)</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> pi = permutation[length - (total_deflation ? i+1 : <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)];</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a> = realCol[pi];</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      </div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="keyword">using</span> <a class="code" href="namespacestd.html#ad33a269e67f055aaa18f57f76b015387">std::swap</a>;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="comment">// swap diagonal and first column entries:</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <a class="code" href="namespaceEigen_1_1internal.html#aefb14fc87518cc6b91063a820a66a21b">swap</a>(diag(i), diag(J));</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keywordflow">if</span>(i!=0 &amp;&amp; J!=0) <a class="code" href="namespaceEigen_1_1internal.html#aefb14fc87518cc6b91063a820a66a21b">swap</a>(col0(i), col0(J));</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="comment">// change columns</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keywordflow">if</span> (m_compU) m_naiveU.col(firstCol+i).segment(firstCol, length + 1).swap(m_naiveU.col(firstCol+J).segment(firstCol, length + 1));</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="keywordflow">else</span>         m_naiveU.col(firstCol+i).segment(0, 2)                .swap(m_naiveU.col(firstCol+J).segment(0, 2));</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordflow">if</span> (m_compV) m_naiveV.col(firstColW + i).segment(firstRowW, length).swap(m_naiveV.col(firstColW + J).segment(firstRowW, length));</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="comment">//update real pos</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> realI = realInd[<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      realCol[realI] = <a class="code" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      realCol[pi] = <a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      realInd[<a class="code" href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>] = realI;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      realInd[<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = pi;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    }</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  }</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;sorted: &quot;</span> &lt;&lt; diag.transpose().format(bdcsvdfmt) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;      : &quot;</span> &lt;&lt; col0.transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    </div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="comment">//condition 4.4</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  {</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> i = length-1;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">while</span>(i&gt;0 &amp;&amp; (<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(diag(i))&lt;considerZero || <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(col0(i))&lt;considerZero)) --<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">for</span>(; i&gt;1;--<a class="code" href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;       <span class="keywordflow">if</span>( (diag(i) - diag(i-1)) &lt; <a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;RealScalar&gt;::epsilon</a>()*maxDiag )</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_DEBUG_VERBOSE</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;deflation 4.4 with i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; because &quot;</span> &lt;&lt; (diag(i) - diag(i-1)) &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span> &lt;&lt; <a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;RealScalar&gt;::epsilon</a>()*diag(i) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        <a class="code" href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a>(<a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(diag(i) - diag(i-1))&lt;epsilon_coarse &amp;&amp; <span class="stringliteral">&quot; diagonal entries are not properly sorted&quot;</span>);</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        deflation44(firstCol, firstCol + shift, firstRowW, firstColW, i-1, i, length);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      }</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  }</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  </div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> j=2;j&lt;length;++<a class="code" href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    assert(diag(j-1)&lt;=diag(j) || <a class="code" href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a>(diag(j))&lt;considerZero);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  </div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="preprocessor">#ifdef EIGEN_BDCSVD_SANITY_CHECKS</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  assert(m_naiveU.allFinite());</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  assert(m_naiveV.allFinite());</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  assert(m_computed.allFinite());</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;}<span class="comment">//end deflation</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="preprocessor">#ifndef __CUDACC__</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">/** \svd_module</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">  *</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">  * \return the singular value decomposition of \c *this computed by Divide &amp; Conquer algorithm</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">  *</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">  * \sa class BDCSVD</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Derived&gt;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;typename MatrixBase&lt;Derived&gt;::PlainObject</a>&gt;</div><div class="line"><a name="l01223"></a><span class="lineno"><a class="line" href="classEigen_1_1MatrixBase.html#ae171b74b5d530846ee0836135ffcf837"> 1223</a></span>&#160;<a class="code" href="classEigen_1_1MatrixBase.html#ae171b74b5d530846ee0836135ffcf837">MatrixBase&lt;Derived&gt;::bdcSvd</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> computationOptions)<span class="keyword"> const</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classEigen_1_1BDCSVD.html">BDCSVD&lt;PlainObject&gt;</a>(*<span class="keyword">this</span>, computationOptions);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;}</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;} <span class="comment">// end namespace Eigen</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="AngleAxis__mimic__euler_8cpp_html_ab3cd915d758008bd19d0f2428fbb354a"><div class="ttname"><a href="AngleAxis__mimic__euler_8cpp.html#ab3cd915d758008bd19d0f2428fbb354a">m</a></div><div class="ttdeci">Matrix3f m</div><div class="ttdef"><b>Definition:</b> <a href="AngleAxis__mimic__euler_8cpp_source.html#l00001">AngleAxis_mimic_euler.cpp:1</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_acf27f41ed044d74ea8e8cbaf17ffdb04"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#acf27f41ed044d74ea8e8cbaf17ffdb04">Eigen::BDCSVD::compute</a></div><div class="ttdeci">BDCSVD &amp; compute(const MatrixType &amp;matrix)</div><div class="ttdoc">Method performing the decomposition of given matrix using current options. </div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00162">BDCSVD.h:162</a></div></div>
<div class="ttc" id="common_8h_html_a94360d20ee722c1bcb23e5b2fbba8554"><div class="ttname"><a href="common_8h.html#a94360d20ee722c1bcb23e5b2fbba8554">matrix</a></div><div class="ttdeci">Map&lt; Matrix&lt; T, Dynamic, Dynamic, ColMajor &gt;, 0, OuterStride&lt;&gt; &gt; matrix(T *data, int rows, int cols, int stride)</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00102">common.h:102</a></div></div>
<div class="ttc" id="bench__gemm_8cpp_html_a052eb942d12b6404aade6fae4b075fb9"><div class="ttname"><a href="bench__gemm_8cpp.html#a052eb942d12b6404aade6fae4b075fb9">Scalar</a></div><div class="ttdeci">SCALAR Scalar</div><div class="ttdef"><b>Definition:</b> <a href="bench__gemm_8cpp_source.html#l00033">bench_gemm.cpp:33</a></div></div>
<div class="ttc" id="datatypes_8h_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="datatypes_8h_source.html#l00020">datatypes.h:20</a></div></div>
<div class="ttc" id="namespaceEigen_1_1half__impl_html_a829ad00a9c93131d5a8342b4ee29d83d"><div class="ttname"><a href="namespaceEigen_1_1half__impl.html#a829ad00a9c93131d5a8342b4ee29d83d">Eigen::half_impl::pow</a></div><div class="ttdeci">EIGEN_STRONG_INLINE EIGEN_DEVICE_FUNC half pow(const half &amp;a, const half &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="Half_8h_source.html#l00407">Half.h:407</a></div></div>
<div class="ttc" id="group__enums_html_ggae3e239fb70022eb8747994cf5d68b4a9a9fa9302d510cee20c26311154937e23f"><div class="ttname"><a href="group__enums.html#ggae3e239fb70022eb8747994cf5d68b4a9a9fa9302d510cee20c26311154937e23f">Eigen::ComputeFullU</a></div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00383">Constants.h:383</a></div></div>
<div class="ttc" id="classEigen_1_1PlainObjectBase_html_ac21ad5f989f320e46958b75ac8d9a1da"><div class="ttname"><a href="classEigen_1_1PlainObjectBase.html#ac21ad5f989f320e46958b75ac8d9a1da">Eigen::PlainObjectBase::setZero</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC Derived &amp; setZero(Index size)</div><div class="ttdef"><b>Definition:</b> <a href="CwiseNullaryOp_8h_source.html#l00515">CwiseNullaryOp.h:515</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a43bb7c5a142ebde4c38967c5c3d42910"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a43bb7c5a142ebde4c38967c5c3d42910">Eigen::BDCSVD::m_nRec</a></div><div class="ttdeci">Index m_nRec</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00191">BDCSVD.h:191</a></div></div>
<div class="ttc" id="classEigen_1_1MatrixBase_html_ae171b74b5d530846ee0836135ffcf837"><div class="ttname"><a href="classEigen_1_1MatrixBase.html#ae171b74b5d530846ee0836135ffcf837">Eigen::MatrixBase::bdcSvd</a></div><div class="ttdeci">BDCSVD&lt; PlainObject &gt; bdcSvd(unsigned int computationOptions=0) const</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l01223">BDCSVD.h:1223</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_ad30a7a883b86028c45559593c7a678a2"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#ad30a7a883b86028c45559593c7a678a2">Eigen::BDCSVD::ArrayRef</a></div><div class="ttdeci">Ref&lt; ArrayXr &gt; ArrayRef</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00100">BDCSVD.h:100</a></div></div>
<div class="ttc" id="classEigen_1_1PlainObjectBase_html_aa86254240c534cc55143f38af58c8bdf"><div class="ttname"><a href="classEigen_1_1PlainObjectBase.html#aa86254240c534cc55143f38af58c8bdf">Eigen::PlainObjectBase::swap</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC void swap(DenseBase&lt; OtherDerived &gt; &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="PlainObjectBase_8h_source.html#l00882">PlainObjectBase.h:882</a></div></div>
<div class="ttc" id="classEigen_1_1internal_1_1UpperBidiagonalization_html_a6ab970ae51909e56ceb63a49e06fdc98"><div class="ttname"><a href="classEigen_1_1internal_1_1UpperBidiagonalization.html#a6ab970ae51909e56ceb63a49e06fdc98">Eigen::internal::UpperBidiagonalization::householderV</a></div><div class="ttdeci">const HouseholderVSequenceType householderV()</div><div class="ttdef"><b>Definition:</b> <a href="UpperBidiagonalization_8h_source.html#l00076">UpperBidiagonalization.h:76</a></div></div>
<div class="ttc" id="benchVecAdd_8cpp_html_a846c9667e34d56c560bb7f0ac6e173f6"><div class="ttname"><a href="benchVecAdd_8cpp.html#a846c9667e34d56c560bb7f0ac6e173f6">b</a></div><div class="ttdeci">Scalar * b</div><div class="ttdef"><b>Definition:</b> <a href="benchVecAdd_8cpp_source.html#l00017">benchVecAdd.cpp:17</a></div></div>
<div class="ttc" id="Tutorial__commainit__02_8cpp_html_a4407a60bc4387adae24cee658711f2d9"><div class="ttname"><a href="Tutorial__commainit__02_8cpp.html#a4407a60bc4387adae24cee658711f2d9">cols</a></div><div class="ttdeci">int cols</div><div class="ttdef"><b>Definition:</b> <a href="Tutorial__commainit__02_8cpp_source.html#l00001">Tutorial_commainit_02.cpp:1</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_acf9211e5353d60fc3209d62fa0e2bdf7"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#acf9211e5353d60fc3209d62fa0e2bdf7">Eigen::BDCSVD::MatrixX</a></div><div class="ttdeci">Matrix&lt; Scalar, Dynamic, Dynamic, ColMajor &gt; MatrixX</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00095">BDCSVD.h:95</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a4c38005126c75b1ba3b1b95117b4546d"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a4c38005126c75b1ba3b1b95117b4546d">Eigen::BDCSVD::MatrixUType</a></div><div class="ttdeci">Base::MatrixUType MatrixUType</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00091">BDCSVD.h:91</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a7b32c2adca9f10283820f437f08f6271"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a7b32c2adca9f10283820f437f08f6271">Eigen::BDCSVD::MatrixXr</a></div><div class="ttdeci">Matrix&lt; RealScalar, Dynamic, Dynamic, ColMajor &gt; MatrixXr</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00096">BDCSVD.h:96</a></div></div>
<div class="ttc" id="namespacenumpy_html_adb46bf70564cdd5c1175a9c6050262c8aa66f9fab761283c08285395a1a64c840"><div class="ttname"><a href="namespacenumpy.html#adb46bf70564cdd5c1175a9c6050262c8aa66f9fab761283c08285395a1a64c840">numpy::copy</a></div><div class="ttdef"><b>Definition:</b> <a href="NumpyUtils_8h_source.html#l00042">NumpyUtils.h:42</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_aa21c0cc5e99c861970bae45d94cae9ad"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#aa21c0cc5e99c861970bae45d94cae9ad">Eigen::BDCSVD::setSwitchSize</a></div><div class="ttdeci">void setSwitchSize(int s)</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00167">BDCSVD.h:167</a></div></div>
<div class="ttc" id="datatypes_8h_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="datatypes_8h_source.html#l00019">datatypes.h:19</a></div></div>
<div class="ttc" id="classEigen_1_1Map_html"><div class="ttname"><a href="classEigen_1_1Map.html">Eigen::Map</a></div><div class="ttdoc">A matrix or vector expression mapping an existing array of data. </div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00088">Map.h:88</a></div></div>
<div class="ttc" id="classEigen_1_1SVDBase_html_afc7fe1546b0f6e1801b86f22f5664cb8"><div class="ttname"><a href="classEigen_1_1SVDBase.html#afc7fe1546b0f6e1801b86f22f5664cb8">Eigen::SVDBase&lt; JacobiSVD&lt; _MatrixType, QRPreconditioner &gt; &gt;::matrixU</a></div><div class="ttdeci">const MatrixUType &amp; matrixU() const</div><div class="ttdef"><b>Definition:</b> <a href="SVDBase_8h_source.html#l00083">SVDBase.h:83</a></div></div>
<div class="ttc" id="BiCGSTAB__simple_8cpp_html_a5150192f625f4d7970d61169b9567f39"><div class="ttname"><a href="BiCGSTAB__simple_8cpp.html#a5150192f625f4d7970d61169b9567f39">n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="BiCGSTAB__simple_8cpp_source.html#l00001">BiCGSTAB_simple.cpp:1</a></div></div>
<div class="ttc" id="benchVecAdd_8cpp_html_a41689956983587b085f9da3e48f31d99"><div class="ttname"><a href="benchVecAdd_8cpp.html#a41689956983587b085f9da3e48f31d99">c</a></div><div class="ttdeci">Scalar Scalar * c</div><div class="ttdef"><b>Definition:</b> <a href="benchVecAdd_8cpp_source.html#l00017">benchVecAdd.cpp:17</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a1e177918a1acf8153ff5f323fbeed9fe"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a1e177918a1acf8153ff5f323fbeed9fe">Eigen::BDCSVD::ArrayXr</a></div><div class="ttdeci">Array&lt; RealScalar, Dynamic, 1 &gt; ArrayXr</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00098">BDCSVD.h:98</a></div></div>
<div class="ttc" id="classEigen_1_1internal_1_1UpperBidiagonalization_html_a39887f7712de5be5a0487e9f6357b9da"><div class="ttname"><a href="classEigen_1_1internal_1_1UpperBidiagonalization.html#a39887f7712de5be5a0487e9f6357b9da">Eigen::internal::UpperBidiagonalization::householderU</a></div><div class="ttdeci">const HouseholderUSequenceType householderU() const</div><div class="ttdef"><b>Definition:</b> <a href="UpperBidiagonalization_8h_source.html#l00070">UpperBidiagonalization.h:70</a></div></div>
<div class="ttc" id="namespaceEigen_html"><div class="ttname"><a href="namespaceEigen.html">Eigen</a></div><div class="ttdoc">Namespace containing all symbols from the Eigen library. </div><div class="ttdef"><b>Definition:</b> <a href="bench__norm_8cpp_source.html#l00085">bench_norm.cpp:85</a></div></div>
<div class="ttc" id="ArrayCwiseUnaryOps_8h_html_a656b9217a2fcb6de59dc8d1eb3079cc7"><div class="ttname"><a href="ArrayCwiseUnaryOps_8h.html#a656b9217a2fcb6de59dc8d1eb3079cc7">sqrt</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC const SqrtReturnType sqrt() const</div><div class="ttdef"><b>Definition:</b> <a href="ArrayCwiseUnaryOps_8h_source.html#l00152">ArrayCwiseUnaryOps.h:152</a></div></div>
<div class="ttc" id="classEigen_1_1JacobiRotation_html"><div class="ttname"><a href="classEigen_1_1JacobiRotation.html">Eigen::JacobiRotation</a></div><div class="ttdoc">Rotation given by a cosine-sine pair. </div><div class="ttdef"><b>Definition:</b> <a href="ForwardDeclarations_8h_source.html#l00263">ForwardDeclarations.h:263</a></div></div>
<div class="ttc" id="structEigen_1_1NumTraits_html"><div class="ttname"><a href="structEigen_1_1NumTraits.html">Eigen::NumTraits</a></div><div class="ttdoc">Holds information about the various numeric (i.e. scalar) types allowed by Eigen. ...</div><div class="ttdef"><b>Definition:</b> <a href="NumTraits_8h_source.html#l00150">NumTraits.h:150</a></div></div>
<div class="ttc" id="bench__gemm_8cpp_html_a37a83060ac796961b44991c836f083f7"><div class="ttname"><a href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a></div><div class="ttdeci">Matrix&lt; SCALARB, Dynamic, Dynamic &gt; B</div><div class="ttdef"><b>Definition:</b> <a href="bench__gemm_8cpp_source.html#l00036">bench_gemm.cpp:36</a></div></div>
<div class="ttc" id="Macros_8h_html_af2d58514e6156c4da2d4af66fafd0b12"><div class="ttname"><a href="Macros_8h.html#af2d58514e6156c4da2d4af66fafd0b12">EIGEN_SIZE_MIN_PREFER_FIXED</a></div><div class="ttdeci">#define EIGEN_SIZE_MIN_PREFER_FIXED(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="Macros_8h_source.html#l00886">Macros.h:886</a></div></div>
<div class="ttc" id="classEigen_1_1SVDBase_html_a083d99e05949bab974bbff2966606b7f"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a083d99e05949bab974bbff2966606b7f">Eigen::SVDBase::cols</a></div><div class="ttdeci">Index cols() const</div><div class="ttdef"><b>Definition:</b> <a href="SVDBase_8h_source.html#l00193">SVDBase.h:193</a></div></div>
<div class="ttc" id="Cwise__product_8cpp_html_ad2cbe4616e813eb9af81732dca777b24"><div class="ttname"><a href="Cwise__product_8cpp.html#ad2cbe4616e813eb9af81732dca777b24">a</a></div><div class="ttdeci">Array33i a</div><div class="ttdef"><b>Definition:</b> <a href="Cwise__product_8cpp_source.html#l00001">Cwise_product.cpp:1</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a94b71ee8ecf0b6b621a1267cf136adc9"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a94b71ee8ecf0b6b621a1267cf136adc9">Eigen::BDCSVD::m_naiveV</a></div><div class="ttdeci">MatrixXr m_naiveV</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00189">BDCSVD.h:189</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a76dcaed5bc2dd1c37832805fa8fed943"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a76dcaed5bc2dd1c37832805fa8fed943">Eigen::BDCSVD::m_computed</a></div><div class="ttdeci">MatrixXr m_computed</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00190">BDCSVD.h:190</a></div></div>
<div class="ttc" id="ArrayCwiseUnaryOps_8h_html_a35560f7dbf19244fda7e463d14157c43"><div class="ttname"><a href="ArrayCwiseUnaryOps_8h.html#a35560f7dbf19244fda7e463d14157c43">abs</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC EIGEN_STRONG_INLINE const AbsReturnType abs() const</div><div class="ttdef"><b>Definition:</b> <a href="ArrayCwiseUnaryOps_8h_source.html#l00043">ArrayCwiseUnaryOps.h:43</a></div></div>
<div class="ttc" id="PartialRedux__count_8cpp_html_acbe60897559b79afc28b79b0687b5f29"><div class="ttname"><a href="PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a></div><div class="ttdeci">cout&lt;&lt; &quot;Here is the matrix m:&quot;&lt;&lt; endl&lt;&lt; m&lt;&lt; endl;Matrix&lt; ptrdiff_t, 3, 1 &gt; res</div><div class="ttdef"><b>Definition:</b> <a href="PartialRedux__count_8cpp_source.html#l00003">PartialRedux_count.cpp:3</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a1a1140cddb7727637b5e33d9f3b13299"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a1a1140cddb7727637b5e33d9f3b13299">Eigen::BDCSVD::MatrixVType</a></div><div class="ttdeci">Base::MatrixVType MatrixVType</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00092">BDCSVD.h:92</a></div></div>
<div class="ttc" id="benchVecAdd_8cpp_html_acc017e1f28bf1b83809251a830f315c3"><div class="ttname"><a href="benchVecAdd_8cpp.html#acc017e1f28bf1b83809251a830f315c3">size</a></div><div class="ttdeci">Scalar Scalar int size</div><div class="ttdef"><b>Definition:</b> <a href="benchVecAdd_8cpp_source.html#l00017">benchVecAdd.cpp:17</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_ad62998546febd86ba715a9eae4c47b4b"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#ad62998546febd86ba715a9eae4c47b4b">Eigen::BDCSVD::m_workspace</a></div><div class="ttdeci">ArrayXr m_workspace</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00192">BDCSVD.h:192</a></div></div>
<div class="ttc" id="classEigen_1_1VectorBlock_html"><div class="ttname"><a href="classEigen_1_1VectorBlock.html">Eigen::VectorBlock</a></div><div class="ttdoc">Expression of a fixed-size or dynamic-size sub-vector. </div><div class="ttdef"><b>Definition:</b> <a href="ForwardDeclarations_8h_source.html#l00087">ForwardDeclarations.h:87</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a8bfc4be4bdc669038298ea29b940532f"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a8bfc4be4bdc669038298ea29b940532f">Eigen::BDCSVD::m_workspaceI</a></div><div class="ttdeci">ArrayXi m_workspaceI</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00193">BDCSVD.h:193</a></div></div>
<div class="ttc" id="ArrayCwiseUnaryOps_8h_html_a4921dbe62d034394f6fa7810e8711356"><div class="ttname"><a href="ArrayCwiseUnaryOps_8h.html#a4921dbe62d034394f6fa7810e8711356">abs2</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC EIGEN_STRONG_INLINE const Abs2ReturnType abs2() const</div><div class="ttdef"><b>Definition:</b> <a href="ArrayCwiseUnaryOps_8h_source.html#l00071">ArrayCwiseUnaryOps.h:71</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a3e1fa48b3d042b7daf7392724a68bb60"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a3e1fa48b3d042b7daf7392724a68bb60">Eigen::BDCSVD::BDCSVD</a></div><div class="ttdeci">BDCSVD(Index rows, Index cols, unsigned int computationOptions=0)</div><div class="ttdoc">Default Constructor with memory preallocation. </div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00118">BDCSVD.h:118</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_aab1c377c616062cc85356e47312cb412"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#aab1c377c616062cc85356e47312cb412">Eigen::BDCSVD::IndicesRef</a></div><div class="ttdeci">Ref&lt; ArrayXi &gt; IndicesRef</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00101">BDCSVD.h:101</a></div></div>
<div class="ttc" id="classEigen_1_1PlainObjectBase_html_a99d9054ee2d5a40c6e00ded0265e9cea"><div class="ttname"><a href="classEigen_1_1PlainObjectBase.html#a99d9054ee2d5a40c6e00ded0265e9cea">Eigen::PlainObjectBase::resize</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC EIGEN_STRONG_INLINE void resize(Index rows, Index cols)</div><div class="ttdef"><b>Definition:</b> <a href="PlainObjectBase_8h_source.html#l00279">PlainObjectBase.h:279</a></div></div>
<div class="ttc" id="classEigen_1_1SVDBase_html"><div class="ttname"><a href="classEigen_1_1SVDBase.html">Eigen::SVDBase</a></div><div class="ttdoc">Base class of SVD algorithms. </div><div class="ttdef"><b>Definition:</b> <a href="SVDBase_8h_source.html#l00048">SVDBase.h:48</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a8c3310eee662af4ca2428f7afd1472ed"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a8c3310eee662af4ca2428f7afd1472ed">Eigen::BDCSVD::MatrixType</a></div><div class="ttdeci">_MatrixType MatrixType</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00077">BDCSVD.h:77</a></div></div>
<div class="ttc" id="EigenSolver__EigenSolver__MatrixType_8cpp_html_a77c224aa52b434918ce65c33175aa8ad"><div class="ttname"><a href="EigenSolver__EigenSolver__MatrixType_8cpp.html#a77c224aa52b434918ce65c33175aa8ad">V</a></div><div class="ttdeci">MatrixXcd V</div><div class="ttdef"><b>Definition:</b> <a href="EigenSolver__EigenSolver__MatrixType_8cpp_source.html#l00015">EigenSolver_EigenSolver_MatrixType.cpp:15</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_abdf2b178ad413766bc1b292fcef701e2"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#abdf2b178ad413766bc1b292fcef701e2">Eigen::BDCSVD::~BDCSVD</a></div><div class="ttdeci">~BDCSVD()</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00140">BDCSVD.h:140</a></div></div>
<div class="ttc" id="structEigen_1_1internal_1_1traits_3_01BDCSVD_3_01__MatrixType_01_4_01_4_html_afd85342058bafd2b0fd201db71b54f50"><div class="ttname"><a href="structEigen_1_1internal_1_1traits_3_01BDCSVD_3_01__MatrixType_01_4_01_4.html#afd85342058bafd2b0fd201db71b54f50">Eigen::internal::traits&lt; BDCSVD&lt; _MatrixType &gt; &gt;::MatrixType</a></div><div class="ttdeci">_MatrixType MatrixType</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00038">BDCSVD.h:38</a></div></div>
<div class="ttc" id="namespaceEigen_html_a62e77e0933482dafde8fe197d9a2cfde"><div class="ttname"><a href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a></div><div class="ttdeci">EIGEN_DEFAULT_DENSE_INDEX_TYPE Index</div><div class="ttdoc">The Index type as used for the API. </div><div class="ttdef"><b>Definition:</b> <a href="Meta_8h_source.html#l00033">Meta.h:33</a></div></div>
<div class="ttc" id="BlockMethods_8h_html_a9195fdd59174bd73125c79f2ca38b392"><div class="ttname"><a href="BlockMethods_8h.html#a9195fdd59174bd73125c79f2ca38b392">head</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC SegmentReturnType head(Index n)</div><div class="ttdoc">This is the const version of head(Index). </div><div class="ttdef"><b>Definition:</b> <a href="BlockMethods_8h_source.html#l00919">BlockMethods.h:919</a></div></div>
<div class="ttc" id="Macros_8h_html_acaa7ba89800cfe18d5fd6eed620aea9c"><div class="ttname"><a href="Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a></div><div class="ttdeci">#define eigen_assert(x)</div><div class="ttdef"><b>Definition:</b> <a href="Macros_8h_source.html#l00577">Macros.h:577</a></div></div>
<div class="ttc" id="namespacetraits_html"><div class="ttname"><a href="namespacetraits.html">traits</a></div><div class="ttdef"><b>Definition:</b> <a href="Traits_8h_source.html#l00020">Traits.h:20</a></div></div>
<div class="ttc" id="group__enums_html_gga45fe06e29902b7a2773de05ba27b47a1ae12d0f8f869c40c76128260af2242bc8"><div class="ttname"><a href="group__enums.html#gga45fe06e29902b7a2773de05ba27b47a1ae12d0f8f869c40c76128260af2242bc8">Eigen::Aligned</a></div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00235">Constants.h:235</a></div></div>
<div class="ttc" id="Cwise__array__power__array_8cpp_html_aa9e3025f5efca2c2a39d785652f2d710"><div class="ttname"><a href="Cwise__array__power__array_8cpp.html#aa9e3025f5efca2c2a39d785652f2d710">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="level1__cplx__impl_8h_html_a462761ca92ad97a9a705cb875828b0b8"><div class="ttname"><a href="level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a></div><div class="ttdeci">RealScalar s</div><div class="ttdef"><b>Definition:</b> <a href="level1__cplx__impl_8h_source.html#l00104">level1_cplx_impl.h:104</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a52e3c627775010775c64d16a00cdb770"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a52e3c627775010775c64d16a00cdb770">Eigen::BDCSVD::compute</a></div><div class="ttdeci">BDCSVD &amp; compute(const MatrixType &amp;matrix, unsigned int computationOptions)</div><div class="ttdoc">Method performing the decomposition of given matrix using custom options. </div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00238">BDCSVD.h:238</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a1e07b25c4a606cee8f34cdc75189a3b8"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a1e07b25c4a606cee8f34cdc75189a3b8">Eigen::BDCSVD::m_algoswap</a></div><div class="ttdeci">int m_algoswap</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00194">BDCSVD.h:194</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a302746d9c534cd513c1df87c7ae4850d"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a302746d9c534cd513c1df87c7ae4850d">Eigen::BDCSVD::BDCSVD</a></div><div class="ttdeci">BDCSVD(const MatrixType &amp;matrix, unsigned int computationOptions=0)</div><div class="ttdoc">Constructor performing the decomposition of given matrix. </div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00134">BDCSVD.h:134</a></div></div>
<div class="ttc" id="Jacobi__makeJacobi_8cpp_html_a4804f9d1c212b9655934738d0ae395ab"><div class="ttname"><a href="Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a></div><div class="ttdeci">JacobiRotation&lt; float &gt; J</div><div class="ttdef"><b>Definition:</b> <a href="Jacobi__makeJacobi_8cpp_source.html#l00003">Jacobi_makeJacobi.cpp:3</a></div></div>
<div class="ttc" id="classEigen_1_1PlainObjectBase_html_a10b8b33b7587da564415561aa246f78f"><div class="ttname"><a href="classEigen_1_1PlainObjectBase.html#a10b8b33b7587da564415561aa246f78f">Eigen::PlainObjectBase::cols</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC EIGEN_STRONG_INLINE Index cols() const</div><div class="ttdef"><b>Definition:</b> <a href="PlainObjectBase_8h_source.html#l00153">PlainObjectBase.h:153</a></div></div>
<div class="ttc" id="bench__gemm_8cpp_html_acb5c3dc237f99cf17167e8a629f01b43"><div class="ttname"><a href="bench__gemm_8cpp.html#acb5c3dc237f99cf17167e8a629f01b43">RealScalar</a></div><div class="ttdeci">NumTraits&lt; Scalar &gt;::Real RealScalar</div><div class="ttdef"><b>Definition:</b> <a href="bench__gemm_8cpp_source.html#l00034">bench_gemm.cpp:34</a></div></div>
<div class="ttc" id="classEigen_1_1internal_1_1UpperBidiagonalization_html"><div class="ttname"><a href="classEigen_1_1internal_1_1UpperBidiagonalization.html">Eigen::internal::UpperBidiagonalization</a></div><div class="ttdef"><b>Definition:</b> <a href="UpperBidiagonalization_8h_source.html#l00020">UpperBidiagonalization.h:20</a></div></div>
<div class="ttc" id="classEigen_1_1SVDBase_html_a7426695e87c152fbb8bc7834dd8e6ce3"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a7426695e87c152fbb8bc7834dd8e6ce3">Eigen::SVDBase::SingularValuesType</a></div><div class="ttdeci">internal::plain_diag_type&lt; MatrixType, RealScalar &gt;::type SingularValuesType</div><div class="ttdef"><b>Definition:</b> <a href="SVDBase_8h_source.html#l00069">SVDBase.h:69</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_ade7ebb87b1735432218681831b1801cc"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#ade7ebb87b1735432218681831b1801cc">Eigen::BDCSVD::m_numIters</a></div><div class="ttdeci">int m_numIters</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00209">BDCSVD.h:209</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_aaeab2cfc3f87e2a2c595a9d5b4d97c71"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#aaeab2cfc3f87e2a2c595a9d5b4d97c71">Eigen::BDCSVD::Scalar</a></div><div class="ttdeci">MatrixType::Scalar Scalar</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00078">BDCSVD.h:78</a></div></div>
<div class="ttc" id="ComplexEigenSolver__compute_8cpp_html_a8a21c18d4aa23228bc1b89f9b12182be"><div class="ttname"><a href="ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a></div><div class="ttdeci">cout&lt;&lt; &quot;The eigenvalues of A are:&quot;&lt;&lt; endl&lt;&lt; ces.eigenvalues()&lt;&lt; endl;cout&lt;&lt; &quot;The matrix of eigenvectors, V, is:&quot;&lt;&lt; endl&lt;&lt; ces.eigenvectors()&lt;&lt; endl&lt;&lt; endl;complex&lt; float &gt; lambda</div><div class="ttdef"><b>Definition:</b> <a href="ComplexEigenSolver__compute_8cpp_source.html#l00009">ComplexEigenSolver_compute.cpp:9</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html"><div class="ttname"><a href="classEigen_1_1BDCSVD.html">Eigen::BDCSVD</a></div><div class="ttdoc">class Bidiagonal Divide and Conquer SVD </div><div class="ttdef"><b>Definition:</b> <a href="ForwardDeclarations_8h_source.html#l00259">ForwardDeclarations.h:259</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_aad17038f9628ce5ed6e1461a67cd3a03"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#aad17038f9628ce5ed6e1461a67cd3a03">Eigen::BDCSVD::Literal</a></div><div class="ttdeci">NumTraits&lt; RealScalar &gt;::Literal Literal</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00080">BDCSVD.h:80</a></div></div>
<div class="ttc" id="classEigen_1_1Ref_html"><div class="ttname"><a href="classEigen_1_1Ref.html">Eigen::Ref</a></div><div class="ttdoc">A matrix or vector expression mapping an existing expression. </div><div class="ttdef"><b>Definition:</b> <a href="Ref_8h_source.html#l00190">Ref.h:190</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a9dea0e28217993ad7de85351357724a7"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a9dea0e28217993ad7de85351357724a7">Eigen::BDCSVD::ArrayXi</a></div><div class="ttdeci">Array&lt; Index, 1, Dynamic &gt; ArrayXi</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00099">BDCSVD.h:99</a></div></div>
<div class="ttc" id="namespaceinternal_html"><div class="ttname"><a href="namespaceinternal.html">internal</a></div><div class="ttdef"><b>Definition:</b> <a href="BandTriangularSolver_8h_source.html#l00013">BandTriangularSolver.h:13</a></div></div>
<div class="ttc" id="classEigen_1_1internal_1_1UpperBidiagonalization_html_a970d328a7b5fd3ad7ee9dd42c9952577"><div class="ttname"><a href="classEigen_1_1internal_1_1UpperBidiagonalization.html#a970d328a7b5fd3ad7ee9dd42c9952577">Eigen::internal::UpperBidiagonalization::bidiagonal</a></div><div class="ttdeci">const BidiagonalType &amp; bidiagonal() const</div><div class="ttdef"><b>Definition:</b> <a href="UpperBidiagonalization_8h_source.html#l00068">UpperBidiagonalization.h:68</a></div></div>
<div class="ttc" id="classEigen_1_1Block_html"><div class="ttname"><a href="classEigen_1_1Block.html">Eigen::Block</a></div><div class="ttdoc">Expression of a fixed-size or dynamic-size block. </div><div class="ttdef"><b>Definition:</b> <a href="Block_8h_source.html#l00103">Block.h:103</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a01ac6b6ddf81569780bf6449e8484a6c"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a01ac6b6ddf81569780bf6449e8484a6c">Eigen::BDCSVD::m_isTranspose</a></div><div class="ttdeci">bool m_isTranspose</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00195">BDCSVD.h:195</a></div></div>
<div class="ttc" id="classEigen_1_1SVDBase_html_afe8a555f38393a319a71ec0f0331c9ef"><div class="ttname"><a href="classEigen_1_1SVDBase.html#afe8a555f38393a319a71ec0f0331c9ef">Eigen::SVDBase&lt; JacobiSVD&lt; _MatrixType, QRPreconditioner &gt; &gt;::nonzeroSingularValues</a></div><div class="ttdeci">Index nonzeroSingularValues() const</div><div class="ttdef"><b>Definition:</b> <a href="SVDBase_8h_source.html#l00118">SVDBase.h:118</a></div></div>
<div class="ttc" id="classEigen_1_1Array_html"><div class="ttname"><a href="classEigen_1_1Array.html">Eigen::Array&lt; RealScalar, Dynamic, 1 &gt;</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a39514816d38f9c418cf3f3514b511c2c"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a39514816d38f9c418cf3f3514b511c2c">Eigen::BDCSVD::BDCSVD</a></div><div class="ttdeci">BDCSVD()</div><div class="ttdoc">Default Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00108">BDCSVD.h:108</a></div></div>
<div class="ttc" id="classEigen_1_1JacobiSVD_html"><div class="ttname"><a href="classEigen_1_1JacobiSVD.html">Eigen::JacobiSVD</a></div><div class="ttdoc">Two-sided Jacobi SVD decomposition of a rectangular matrix. </div><div class="ttdef"><b>Definition:</b> <a href="ForwardDeclarations_8h_source.html#l00258">ForwardDeclarations.h:258</a></div></div>
<div class="ttc" id="Tutorial__Map__using_8cpp_html_a7fe964f6b1afd4591f637999272ab9a2"><div class="ttname"><a href="Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a></div><div class="ttdeci">float * p</div><div class="ttdef"><b>Definition:</b> <a href="Tutorial__Map__using_8cpp_source.html#l00009">Tutorial_Map_using.cpp:9</a></div></div>
<div class="ttc" id="Tutorial__commainit__02_8cpp_html_a061459acc9e078fa4699e0e349887215"><div class="ttname"><a href="Tutorial__commainit__02_8cpp.html#a061459acc9e078fa4699e0e349887215">rows</a></div><div class="ttdeci">int rows</div><div class="ttdef"><b>Definition:</b> <a href="Tutorial__commainit__02_8cpp_source.html#l00001">Tutorial_commainit_02.cpp:1</a></div></div>
<div class="ttc" id="classEigen_1_1SVDBase_html_a4e7bac123570c348f7ed6be909e1e474"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a4e7bac123570c348f7ed6be909e1e474">Eigen::SVDBase&lt; JacobiSVD&lt; _MatrixType, QRPreconditioner &gt; &gt;::singularValues</a></div><div class="ttdeci">const SingularValuesType &amp; singularValues() const</div><div class="ttdef"><b>Definition:</b> <a href="SVDBase_8h_source.html#l00111">SVDBase.h:111</a></div></div>
<div class="ttc" id="classbool_html"><div class="ttname"><a href="classbool.html">bool</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a0ea2c57bf088d5fc480ad81945157079"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a0ea2c57bf088d5fc480ad81945157079">Eigen::BDCSVD::VectorType</a></div><div class="ttdeci">Matrix&lt; RealScalar, Dynamic, 1 &gt; VectorType</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00097">BDCSVD.h:97</a></div></div>
<div class="ttc" id="gnuplot__common__settings_8hh_html_a028be1055fb10c679b6153f8dcd0befa"><div class="ttname"><a href="gnuplot__common__settings_8hh.html#a028be1055fb10c679b6153f8dcd0befa">scale</a></div><div class="ttdeci">set noclip points set clip one set noclip two set bar set border lt lw set xdata set ydata set zdata set x2data set y2data set boxwidth set dummy y set format x g set format y g set format x2 g set format y2 g set format z g set angles radians set nogrid set key title set key left top Right noreverse box linetype linewidth samplen spacing width set nolabel set noarrow set nologscale set logscale x set set pointsize set encoding default set nopolar set noparametric set set set set surface set nocontour set clabel set mapping cartesian set nohidden3d set cntrparam order set cntrparam linear set cntrparam levels auto set cntrparam points set size set set xzeroaxis lt lw set x2zeroaxis lt lw set yzeroaxis lt lw set y2zeroaxis lt lw set tics in set ticslevel set tics scale</div><div class="ttdef"><b>Definition:</b> <a href="gnuplot__common__settings_8hh_source.html#l00012">gnuplot_common_settings.hh:12</a></div></div>
<div class="ttc" id="classEigen_1_1SVDBase_html_a245a453b5e7347f737295c23133238c4"><div class="ttname"><a href="classEigen_1_1SVDBase.html#a245a453b5e7347f737295c23133238c4">Eigen::SVDBase&lt; JacobiSVD&lt; _MatrixType, QRPreconditioner &gt; &gt;::matrixV</a></div><div class="ttdeci">const MatrixVType &amp; matrixV() const</div><div class="ttdef"><b>Definition:</b> <a href="SVDBase_8h_source.html#l00099">SVDBase.h:99</a></div></div>
<div class="ttc" id="classEigen_1_1Diagonal_html"><div class="ttname"><a href="classEigen_1_1Diagonal.html">Eigen::Diagonal</a></div><div class="ttdoc">Expression of a diagonal/subdiagonal/superdiagonal in a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="Diagonal_8h_source.html#l00063">Diagonal.h:63</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a44cd685aa8d3807c006f6557bd69abf8"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a44cd685aa8d3807c006f6557bd69abf8">Eigen::BDCSVD::SingularValuesType</a></div><div class="ttdeci">Base::SingularValuesType SingularValuesType</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00093">BDCSVD.h:93</a></div></div>
<div class="ttc" id="namespaceEigen_html_ad81fa7195215a0ce30017dfac309f0b2"><div class="ttname"><a href="namespaceEigen.html#ad81fa7195215a0ce30017dfac309f0b2">Eigen::Dynamic</a></div><div class="ttdeci">const int Dynamic</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00021">Constants.h:21</a></div></div>
<div class="ttc" id="classEigen_1_1BDCSVD_html_a2eb49279d7a1760eed1346fb8a0da629"><div class="ttname"><a href="classEigen_1_1BDCSVD.html#a2eb49279d7a1760eed1346fb8a0da629">Eigen::BDCSVD::RealScalar</a></div><div class="ttdeci">NumTraits&lt; typename MatrixType::Scalar &gt;::Real RealScalar</div><div class="ttdef"><b>Definition:</b> <a href="BDCSVD_8h_source.html#l00079">BDCSVD.h:79</a></div></div>
<div class="ttc" id="Macros_8h_html_a4e742b5a08636a61784c0e173b61e710"><div class="ttname"><a href="Macros_8h.html#a4e742b5a08636a61784c0e173b61e710">eigen_internal_assert</a></div><div class="ttdeci">#define eigen_internal_assert(x)</div><div class="ttdef"><b>Definition:</b> <a href="Macros_8h_source.html#l00583">Macros.h:583</a></div></div>
<div class="ttc" id="group__enums_html_ggae3e239fb70022eb8747994cf5d68b4a9a36581f7c662f7def31efd500c284f930"><div class="ttname"><a href="group__enums.html#ggae3e239fb70022eb8747994cf5d68b4a9a36581f7c662f7def31efd500c284f930">Eigen::ComputeFullV</a></div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00387">Constants.h:387</a></div></div>
<div class="ttc" id="dense__solvers_8cpp_html_a8ef543dd0111424127c81cdd31f3753a"><div class="ttname"><a href="dense__solvers_8cpp.html#a8ef543dd0111424127c81cdd31f3753a">compute</a></div><div class="ttdeci">EIGEN_DONT_INLINE void compute(Solver &amp;solver, const MatrixType &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="dense__solvers_8cpp_source.html#l00025">dense_solvers.cpp:25</a></div></div>
<div class="ttc" id="classEigen_1_1Matrix_html"><div class="ttname"><a href="classEigen_1_1Matrix.html">Eigen::Matrix&lt; Scalar, RowsAtCompileTime, RowsAtCompileTime, MatrixOptions, MaxRowsAtCompileTime, MaxRowsAtCompileTime &gt;</a></div></div>
<div class="ttc" id="gnuplot__common__settings_8hh_html_a5fd331c99e778f04762be6d8173eb4d2"><div class="ttname"><a href="gnuplot__common__settings_8hh.html#a5fd331c99e778f04762be6d8173eb4d2">x</a></div><div class="ttdeci">set noclip points set clip one set noclip two set bar set border lt lw set xdata set ydata set zdata set x2data set y2data set boxwidth set dummy x</div><div class="ttdef"><b>Definition:</b> <a href="gnuplot__common__settings_8hh_source.html#l00012">gnuplot_common_settings.hh:12</a></div></div>
<div class="ttc" id="Macros_8h_html_a2a07ba221d47a7d636fd13678c8c75b3"><div class="ttname"><a href="Macros_8h.html#a2a07ba221d47a7d636fd13678c8c75b3">EIGEN_SIZE_MIN_PREFER_DYNAMIC</a></div><div class="ttdeci">#define EIGEN_SIZE_MIN_PREFER_DYNAMIC(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="Macros_8h_source.html#l00878">Macros.h:878</a></div></div>
<div class="ttc" id="BiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="BiCGSTAB__step__by__step_8cpp_source.html#l00009">BiCGSTAB_step_by_step.cpp:9</a></div></div>
<div class="ttc" id="namespacestd_html_ad33a269e67f055aaa18f57f76b015387"><div class="ttname"><a href="namespacestd.html#ad33a269e67f055aaa18f57f76b015387">std::swap</a></div><div class="ttdeci">void swap(mpfr::mpreal &amp;x, mpfr::mpreal &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="mpreal_8h_source.html#l02986">mpreal.h:2986</a></div></div>
<div class="ttc" id="tut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> <a href="tut__arithmetic__redux__minmax_8cpp_source.html#l00002">tut_arithmetic_redux_minmax.cpp:2</a></div></div>
<div class="ttc" id="exceptions_8cpp_html_a75f785bf0f51cbc94279c80d143642ae"><div class="ttname"><a href="exceptions_8cpp.html#a75f785bf0f51cbc94279c80d143642ae">conj</a></div><div class="ttdeci">ScalarWithExceptions conj(const ScalarWithExceptions &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="exceptions_8cpp_source.html#l00074">exceptions.cpp:74</a></div></div>
<div class="ttc" id="namespaceEigen_1_1internal_html_aefb14fc87518cc6b91063a820a66a21b"><div class="ttname"><a href="namespaceEigen_1_1internal.html#aefb14fc87518cc6b91063a820a66a21b">Eigen::internal::swap</a></div><div class="ttdeci">void swap(scoped_array&lt; T &gt; &amp;a, scoped_array&lt; T &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="Memory_8h_source.html#l00602">Memory.h:602</a></div></div>
<div class="ttc" id="class__Block_8cpp_html_a9aa86bb792a28202315593b7a0a015fd"><div class="ttname"><a href="class__Block_8cpp.html#a9aa86bb792a28202315593b7a0a015fd">topLeftCorner</a></div><div class="ttdeci">Eigen::Block&lt; Derived &gt; topLeftCorner(MatrixBase&lt; Derived &gt; &amp;m, int rows, int cols)</div><div class="ttdef"><b>Definition:</b> <a href="class__Block_8cpp_source.html#l00008">class_Block.cpp:8</a></div></div>
<div class="ttc" id="namespaceEigen_html_a368a2930040572f113bc1278a6e4f0be"><div class="ttname"><a href="namespaceEigen.html#a368a2930040572f113bc1278a6e4f0be">Eigen::prod</a></div><div class="ttdeci">const Product&lt; Lhs, Rhs &gt; prod(const Lhs &amp;lhs, const Rhs &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="evaluators_8cpp_source.html#l00008">evaluators.cpp:8</a></div></div>
<div class="ttc" id="Matrix__setZero__int_8cpp_html_ad232582b2296c80e793e9f17c6f5a0ab"><div class="ttname"><a href="Matrix__setZero__int_8cpp.html#ad232582b2296c80e793e9f17c6f5a0ab">setZero</a></div><div class="ttdeci">v setZero(3)</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_f811dd580933abc475fb939fab666633.html">libpairinteraction</a></li><li class="navelem"><a class="el" href="dir_953505463e97eb8daee61ba222586c06.html">eigen</a></li><li class="navelem"><a class="el" href="dir_a04d8aae23b58900f9e979a1d004a0d5.html">Eigen</a></li><li class="navelem"><a class="el" href="dir_4e012583f851648e8329068a42e0b4dd.html">src</a></li><li class="navelem"><a class="el" href="dir_40100d17117e01cd12bbcb37aec902a7.html">SVD</a></li><li class="navelem"><a class="el" href="BDCSVD_8h.html">BDCSVD.h</a></li>
    <li class="footer">Generated on Wed Feb 21 2018 04:50:26 for pairinteraction by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
